[
  {
    "questionId": "q-sec-026",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "IDS/IPS",
    "level": 6,
    "question": "IDS（侵入検知システム）とIPS（侵入防止システム）の違いとして、最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "IDSはネットワーク型のみ、IPSはホスト型のみで動作する",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "IDSにもIPSにも、それぞれネットワーク型（NIDS/NIPS）とホスト型（HIDS/HIPS）の両方があります。動作場所による区分ではなく、検知後の動作に違いがあります。",
          "analogy": "警備員も監視カメラも、建物の中・外どちらにも配置できます。違いは「発見するだけか、止めるかどうか」です。"
        }
      },
      {
        "id": "b",
        "text": "IDSは不正アクセスを検知して通知するだけだが、IPSは検知後に通信を遮断するなどの対応を自動で行う",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "IDSは不正な通信パターンを検知してアラートを出すだけで、通信を止める機能を持ちません。一方、IPSはIDSの機能に加えて、不正と判断した通信を自動的に遮断・拒否するアクティブな防御機能を備えています。",
          "analogy": "IDSは火災報知器のようなものです。火を感知してベルを鳴らす（アラート）だけで、自分では消火しません。IPSはスプリンクラーと組み合わさった火災報知器で、感知したと同時に自動的に水を放出して（通信遮断）火を消そうとします。",
          "deepDive": "IDSには不正パターンと照合するシグネチャ型と、通常状態からの逸脱を検知するアノマリ型（異常検知型）があります。誤検知（正常な通信を不正と判断するFalse Positive）が多い場合、IPSが正常通信を遮断してしまう問題があるため、チューニングが重要です。実運用ではIDSでモニタリングしながら、信頼性が確認できた後にIPSの自動遮断を有効にするアプローチが一般的です。"
        }
      },
      {
        "id": "c",
        "text": "IDSはソフトウェア製品、IPSはハードウェアアプライアンス製品のみである",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "IDSもIPSも、ソフトウェア製品とハードウェアアプライアンス製品の両方が存在します。製品形態による区分ではありません。",
          "analogy": "防犯ベル（IDS相当）もセキュリティゲート（IPS相当）も、どちらもソフトウェア的な実装やハードウェアアプライアンスとして提供されています。"
        }
      },
      {
        "id": "d",
        "text": "IDSはマルウェアを除去し、IPSはネットワーク通信を監視する",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "マルウェアの除去はウイルス対策ソフト（アンチウイルスソフト）の役割です。IDSとIPSはいずれもネットワーク通信の監視・分析を行うものであり、役割の分担がこのような形になっているわけではありません。",
          "analogy": "セキュリティカメラ（IDS）とセキュリティゲート（IPS）はどちらも侵入を扱うものです。害虫を駆除するのはまた別の専門業者（アンチウイルス）の仕事です。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "IDSは不正なアクセスや通信を検知してアラートを通知するだけですが、IPSはそれに加えて不正な通信を自動的に遮断する能動的な防御機能を持っています。",
      "keyPoint": "IDS＝検知・通知のみ、IPS＝検知＋自動遮断（アクティブ防御）",
      "relatedTopics": ["ファイアウォール", "WAF", "シグネチャ型検知", "アノマリ型検知"],
      "studyTip": "IDSとIPSは「D（Detection＝検知）」と「P（Prevention＝防止）」の違いと覚えましょう。Preventionは「事前に防ぐ」つまり自動遮断が含まれます。"
    },
    "tags": ["IDS", "IPS", "侵入検知", "侵入防止", "ネットワークセキュリティ"]
  },
  {
    "questionId": "q-sec-027",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "DMZ",
    "level": 6,
    "question": "DMZ（非武装地帯）に配置するサーバとして、最も適切なものの組み合わせはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "人事データベースサーバと給与計算サーバ",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "人事データベースサーバや給与計算サーバは機密性の高い情報を扱うため、外部からアクセスできるDMZではなく、内部ネットワークに配置すべきです。DMZに置くと不正アクセスのリスクが高まります。",
          "analogy": "会社の給与明細や社員の個人情報を受付ロビーの机の上に置くような行為で、誰でも見られてしまいます。"
        }
      },
      {
        "id": "b",
        "text": "公開WebサーバとメールサーバとDNSサーバ",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "DMZには外部（インターネット）と内部ネットワークの両方と通信する必要があるサーバを配置します。公開Webサーバ（外部利用者がアクセス）、メールサーバ（外部とメールをやり取り）、DNSサーバ（外部からの名前解決要求を受ける）がこれに該当します。万が一これらが侵害されても、DMZから内部ネットワークへの通信は制限されているため、被害が広がりにくくなります。",
          "analogy": "会社の受付ロビー（DMZ）に配置するのは、お客さん（外部）と応対する受付担当者（公開Webサーバ）、郵便の窓口（メールサーバ）、道案内担当（DNSサーバ）です。重要な情報を持つ社員（機密データ）はオフィス奥（内部ネットワーク）に置きます。",
          "deepDive": "DMZは通常、外部ファイアウォールと内部ファイアウォールの2段構成で実現します。外部FW＝インターネット↔DMZ間の制御、内部FW＝DMZ↔内部NW間の制御です。内部FWはDMZから内部への通信を厳しく制限します。FTPサーバやリバースプロキシもDMZへの配置候補です。"
        }
      },
      {
        "id": "c",
        "text": "社内業務アプリケーションサーバと認証サーバ",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "社内業務アプリケーションサーバは社内利用が前提のため、外部からアクセス可能なDMZには配置しません。認証サーバも社内認証情報を管理するため、内部ネットワークに配置すべき重要なサーバです。",
          "analogy": "社員が使う社内システムや、社員証を管理する人事部を受付ロビーに置くと、外部の人に触られてしまいます。"
        }
      },
      {
        "id": "d",
        "text": "バックアップサーバと監視サーバ",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "バックアップサーバはデータの完全性を保つため内部ネットワークに置くべきです。監視サーバも内部ネットワーク全体を監視するため、外部からアクセスできるDMZへの配置は適切ではありません。",
          "analogy": "会社の重要書類のコピー（バックアップ）や防犯カメラのモニター室（監視サーバ）を受付ロビーに置くと、部外者に見られたり操作されたりします。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "DMZには外部と内部の両方と通信が必要な公開サーバ（Webサーバ、メールサーバ、DNSサーバなど）を配置します。機密情報を扱うサーバや社内専用サーバは内部ネットワークに置き、直接外部からアクセスできないようにします。",
      "keyPoint": "DMZに置くのは「外部に公開するサーバ」だけ。機密サーバは内部ネットワークに。",
      "relatedTopics": ["ファイアウォール", "IDS/IPS", "多層防御", "リバースプロキシ"],
      "studyTip": "「外部から直接アクセスが必要かどうか」でDMZ配置か内部配置かを判断しましょう。外部アクセスが必要なものはDMZ、そうでないものは内部です。"
    },
    "tags": ["DMZ", "ネットワーク設計", "多層防御", "ファイアウォール"]
  },
  {
    "questionId": "q-sec-028",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "HTTPS通信の仕組み",
    "level": 6,
    "question": "HTTPS通信でTLSハンドシェイクが完了した後、実際のデータ通信に使用される暗号方式として、最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "RSA暗号方式によってデータ全体を暗号化する",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "RSAなどの公開鍵暗号方式は処理に時間がかかるため、大量のデータを直接暗号化する用途には使いません。TLSではRSAはハンドシェイク時の鍵交換や認証に使用し、実際のデータ通信には高速な共通鍵暗号方式を使います。",
          "analogy": "安全な方法で合言葉（共通鍵）を交換するときに印鑑（RSA）を使いますが、毎回の会話（データ通信）に印鑑は押しません。会話は共通の合言葉で手早く行います。"
        }
      },
      {
        "id": "b",
        "text": "ハンドシェイクで交換したセッション鍵（共通鍵）を用いた共通鍵暗号方式でデータを暗号化する",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "TLSハンドシェイクでは、公開鍵暗号方式（RSAやDiffie-Hellman鍵交換など）を用いてクライアントとサーバが安全にセッション鍵（共通鍵）を共有します。その後の実際のデータ通信では、このセッション鍵を使ったAESなどの共通鍵暗号方式で高速に暗号化します。これをハイブリッド暗号方式と呼びます。",
          "analogy": "最初に鍵の受け渡し（ハンドシェイク）は厳重な手続き（公開鍵暗号）で行い、共通の南京錠の鍵（セッション鍵）を安全に渡します。それ以降はその南京錠で荷物（データ）を施錠して素早く送ります。毎回の荷物に厳重な手続きをしていたら時間がかかってしまいます。",
          "deepDive": "TLS 1.3では鍵交換にDiffie-Hellman（DHE/ECDHE）のみを使用し、Forward Secrecy（前方秘匿性）を保証します。これにより、仮に将来サーバの秘密鍵が漏洩しても、過去の通信は復号できません。TLS 1.2以前で使われていたRSA鍵交換はこの性質を持たないため、TLS 1.3では廃止されました。"
        }
      },
      {
        "id": "c",
        "text": "通信のたびに新しい公開鍵ペアを生成してデータを暗号化する",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "通信のたびに新しい公開鍵ペアを生成する処理は非常に重く、現実的ではありません。TLSでは1回のセッション中は同じセッション鍵（共通鍵）を使い、次のセッションで改めて鍵交換を行います。",
          "analogy": "毎回の会話ごとに新しい錠前を作って送り合っていたら、荷物を受け取る前に何時間も待つことになります。"
        }
      },
      {
        "id": "d",
        "text": "データを圧縮するだけで、暗号化は行わない",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "HTTPSにおいてTLSは確実にデータを暗号化します。圧縮だけでは盗聴から保護できません。なお、TLS 1.3では過去に脆弱性（CRIME攻撃）が指摘されたTLS圧縮機能が廃止されています。",
          "analogy": "荷物を小さく梱包する（圧縮）だけでは、中身は誰でも見られます。鍵のかかった箱（暗号化）に入れてこそ安全です。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "HTTPS通信ではTLSハンドシェイクで公開鍵暗号を使って安全にセッション鍵を交換し、実際のデータ通信にはそのセッション鍵（共通鍵）を用いたAESなどの共通鍵暗号方式を使います。このハイブリッド暗号方式により、安全性と速度を両立しています。",
      "keyPoint": "HTTPS＝ハンドシェイクで公開鍵暗号→データ通信は共通鍵暗号（ハイブリッド暗号）",
      "relatedTopics": ["TLS", "SSL", "公開鍵暗号方式", "共通鍵暗号方式", "AES", "電子証明書"],
      "studyTip": "「なぜ公開鍵暗号方式だけを使わないのか」を押さえましょう。速度の問題があるため、ハイブリッド方式で安全性と効率を両立しています。"
    },
    "tags": ["HTTPS", "TLS", "SSL", "ハイブリッド暗号", "セッション鍵"]
  },
  {
    "questionId": "q-sec-029",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "アクセス制御",
    "level": 6,
    "question": "強制アクセス制御（MAC: Mandatory Access Control）の説明として、最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "ファイルの所有者が自分の判断でアクセス権を他のユーザーに付与できる方式",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "ファイルの所有者が裁量でアクセス権を設定できる方式は、任意アクセス制御（DAC: Discretionary Access Control）です。MACでは所有者の裁量ではなく、システムが設定したポリシーでアクセスが制御されます。",
          "analogy": "自分の持ち物を誰に貸すか自分で決められる方式（DAC）に対して、MAC は「軍の規則上、この文書は大佐以上でないと読めない」という外部ルールで決まる方式です。"
        }
      },
      {
        "id": "b",
        "text": "ユーザーの役職や職責に基づいてアクセス権を付与する方式",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "ユーザーの役職（ロール）に基づいてアクセス権を付与する方式は、役割ベースアクセス制御（RBAC: Role-Based Access Control）です。例えば「管理者」「一般社員」のような役割に権限を割り当てます。",
          "analogy": "「総務部は人事情報を見られる」「営業部は顧客データを見られる」のように部署（役割）で決める方式がRBACです。MACとは別の概念です。"
        }
      },
      {
        "id": "c",
        "text": "システム管理者が設定したセキュリティポリシーに基づき、ユーザーや所有者の意思に関係なくアクセス制御が行われる方式",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "MACでは、システムやOSがセキュリティラベル（例：極秘・秘密・公開などの機密レベル）をリソースとユーザーに付与し、そのラベルの比較によってアクセスを制御します。ファイルの所有者であっても、ポリシーに反したアクセスは許可されません。軍事・政府機関のシステムなどで使われます。",
          "analogy": "軍の機密文書管理システムのようなものです。文書には「極秘」「秘密」「公開」のスタンプ（セキュリティラベル）が押されており、その文書を作った将校でも、自分のセキュリティクリアランス（許可証）のレベルを超えた文書は読めません。「自分が作ったから読める」は通用しません。",
          "deepDive": "MACの代表的なモデルにBell-LaPadulaモデルがあります。「上位のラベルのファイルは読めない（機密性保護）」「下位のラベルのファイルに書けない（情報漏洩防止）」というルールでデータの機密性を厳密に保護します。MACはシステムによる強制力が強い反面、柔軟性に欠けるため、一般的なビジネス環境ではRBACが広く使われています。"
        }
      },
      {
        "id": "d",
        "text": "ユーザーが他のユーザーに代わってアクセス権を管理できる委任制御方式",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "他のユーザーへの権限委任は委任ベースのアクセス制御の概念であり、MACの説明ではありません。MACはむしろユーザーが権限を委任したり変更したりできない、システム主導の制御方式です。",
          "analogy": "軍の機密文書のアクセス権を、一般兵士が「自分の代わりに後輩に権限を与える」ことはできません。それはシステム（軍の規則）が一元的に管理します。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "強制アクセス制御（MAC）はシステム管理者が設定したセキュリティポリシーに従い、ユーザーや所有者の意思に関係なくアクセスを制御する方式です。DAC（所有者が決める）、RBAC（役割で決める）との違いを押さえましょう。",
      "keyPoint": "MAC＝システムのポリシーで強制制御、DAC＝所有者の裁量、RBAC＝役割で制御",
      "relatedTopics": ["DAC", "RBAC", "アクセス制御リスト（ACL）", "Bell-LaPadulaモデル"],
      "studyTip": "MAC・DAC・RBACの3つを比較表で整理しましょう。「誰がアクセス権を決めるか（システム/所有者/管理者）」がポイントです。"
    },
    "tags": ["MAC", "DAC", "RBAC", "アクセス制御", "セキュリティポリシー"]
  },
  {
    "questionId": "q-sec-030",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "ログ管理",
    "level": 6,
    "question": "セキュリティ観点でのログ管理における重要な対策として、最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "ログはシステムの同一ディスクにのみ保存し、ディスク容量節約のため古いものから自動削除する",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "ログを同一ディスクに保存するとシステムが侵害された場合にログも改ざん・削除される可能性があります。また、古いログを自動削除すると、後から調査（フォレンジック）に必要なログが失われる恐れがあります。",
          "analogy": "事件現場の同じ引き出しに捜査記録（ログ）を入れておくと、犯人（攻撃者）がその記録ごと処分できてしまいます。"
        }
      },
      {
        "id": "b",
        "text": "ログの内容は読みやすさを重視して人間が編集・整形してから保存する",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "ログは証拠としての価値を保つため、改ざんなく原文のまま保存することが原則です。人間が編集すると改ざんとみなされ、インシデント調査や法的証拠として使えなくなる可能性があります。",
          "analogy": "裁判の証拠書類を読みやすいように書き直してしまうと、証拠能力がなくなってしまいます。原本をそのまま保管することが重要です。"
        }
      },
      {
        "id": "c",
        "text": "ログはリアルタイムで改ざんを検知するために書き込み専用（追記のみ可能）の形式で保存し、別途安全なサーバに転送して一定期間保管する",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "セキュアなログ管理には次の要素が重要です。①追記専用（Write-Once）の形式でローカルに保存し、改ざんを困難にする ②ログを別サーバ（Syslogサーバや集中ログ管理システム）に転送・複製して、元のシステムが侵害されてもログが保全される ③一定期間（法令や社内規定に従う）保管して、インシデント発生時の調査に備える。これらにより、ログの完全性・可用性・追跡可能性を確保します。",
          "analogy": "警備カメラの映像（ログ）は、録画開始後に上書きできない形式で録画し、別の安全な場所にある録画サーバにも自動転送します。カメラ本体を壊されても、サーバ側に証拠が残ります。映像は一定期間保管して、後からいつでも確認できるようにします。",
          "deepDive": "ログ管理の実践では次の点が重要です。①タイムスタンプの正確さ（NTPによる時刻同期）②ログの完全性保証（ハッシュ値によるログの改ざん検知）③SIEMとの連携によるリアルタイム相関分析④保管期間（個人情報保護法や不正アクセス禁止法の観点では一般的に3ヶ月〜1年程度が目安）⑤適切なアクセス制御（ログ管理者以外はログを変更できないようにする）。"
        }
      },
      {
        "id": "d",
        "text": "ログはシステムの性能向上のため、正常な操作のみを記録して異常操作は記録しない",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "セキュリティ観点では、異常な操作や不審なアクセスこそが最も重要な記録対象です。正常な操作だけを記録しても、インシデントの検知や調査に役立ちません。また、何が「正常」かを事前に判断することも困難です。",
          "analogy": "防犯カメラが「普通に歩いている人だけ撮影して、怪しい人は映さない」と設定するようなもので、全く意味がありません。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "セキュアなログ管理では、追記専用形式での保存、別サーバへの転送・複製、一定期間の保管が重要です。ログの改ざん防止と可用性確保が、インシデント対応と証拠保全の基盤となります。",
      "keyPoint": "ログ管理の3原則＝改ざん防止（追記専用）・複製保管（別サーバ）・一定期間保存",
      "relatedTopics": ["SIEM", "フォレンジック", "証跡管理", "タイムスタンプ", "syslog"],
      "studyTip": "「なぜそうするのか」の理由とセットで覚えましょう。改ざん防止なら追記専用、証拠保全なら複製と保管期間、という対応関係を意識してください。"
    },
    "tags": ["ログ管理", "証跡管理", "フォレンジック", "セキュリティ監査", "改ざん防止"]
  },
  {
    "questionId": "q-sec-031",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "ゼロトラストセキュリティ",
    "level": 7,
    "question": "ゼロトラストセキュリティモデルの基本的な考え方として、最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "社内ネットワーク内のトラフィックは信頼できるものと見なし、外部からのアクセスのみを厳しく検査する",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これは従来の境界型セキュリティ（ペリメータセキュリティ）の考え方です。ゼロトラストはこれと正反対の発想で、社内ネットワークであっても無条件には信頼しません。内部からの脅威（インサイダー攻撃）や、攻撃者が既に内部に侵入しているケースに対処するために生まれた概念です。",
          "analogy": "古い考え方は「お城の堀の外は危険、内側は安全」という発想です。ゼロトラストは「お城の中にもスパイがいるかもしれない」という考え方です。"
        }
      },
      {
        "id": "b",
        "text": "VPNを使って全ての通信を暗号化することで、ネットワーク全体を安全にする",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "VPNによる暗号化はゼロトラストの一要素になりえますが、VPNだけではゼロトラストとは言えません。VPNで接続したユーザーを「信頼済み」として扱ってしまうと、認証情報が盗まれた場合などにリスクが高まります。ゼロトラストは接続場所に関係なく継続的な認証・検証を求めます。",
          "analogy": "VPNは会社の建物に入るための通路（暗号化トンネル）です。ゼロトラストはさらに「建物に入っても、各部屋に入るたびに身分証確認」を求めます。"
        }
      },
      {
        "id": "c",
        "text": "ネットワークの場所（社内・社外）に関係なく、すべてのユーザー・デバイス・アクセス要求を継続的に検証し、最小権限の原則に基づいてアクセスを許可する",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "ゼロトラストの核心は「決して信頼せず、常に検証せよ（Never Trust, Always Verify）」という原則です。社内ネットワークに接続していても自動的には信頼せず、アクセスのたびに①ユーザー認証②デバイスの健全性確認③アクセス対象のリソースに対する最小権限の付与④継続的な監視を行います。クラウド環境やリモートワークの普及で、従来の境界型防御が機能しにくくなったことが背景にあります。",
          "analogy": "空港のセキュリティのようなものです。チェックインカウンターで最初に確認するだけでなく、搭乗口でも、機内でも、着陸後でも、そのつど「この人は本当に搭乗予定者か」を確認します。「さっき確認したからOK」とはならず、各ポイントで都度確認します。",
          "deepDive": "ゼロトラストアーキテクチャの主要コンポーネントには、①IDプロバイダ（IdP）による強力な認証（MFA必須）②エンドポイント管理（デバイスの健全性チェック）③マイクロセグメンテーション（ネットワークの細分化）④継続的な監視とリスクスコアリング⑤SWG（Secure Web Gateway）とCASB（Cloud Access Security Broker）によるクラウドアクセス管理があります。NISTはSP 800-207でゼロトラストアーキテクチャのガイドラインを公表しています。"
        }
      },
      {
        "id": "d",
        "text": "ファイアウォールを多段構成にして、ネットワーク境界の防御を最大化する",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "ファイアウォールの多段構成は多層防御（Defense in Depth）の考え方であり、ゼロトラストとは異なるアプローチです。ゼロトラストはネットワーク境界そのものの概念を否定し、ユーザーやデバイスの継続的な検証に重点を置きます。",
          "analogy": "ファイアウォール多段は「お城の堀を深く・広くする」発想で、従来型の境界防御の延長です。ゼロトラストは「堀の外も内も同じように疑い続ける」全く別のアプローチです。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "ゼロトラストセキュリティは「Never Trust, Always Verify（決して信頼せず、常に検証せよ）」を原則とし、ネットワーク内外を問わず全てのアクセスを継続的に検証・最小権限でアクセスを許可するセキュリティモデルです。",
      "keyPoint": "ゼロトラスト＝場所を問わず全アクセスを継続検証＋最小権限の原則",
      "relatedTopics": ["多要素認証（MFA）", "マイクロセグメンテーション", "IDaaS", "SASE", "ペリメータセキュリティ"],
      "studyTip": "従来の「境界型セキュリティ（内側は安全）」との対比でゼロトラストを理解すると覚えやすいです。テレワークやクラウド化が普及した背景も合わせて押さえましょう。"
    },
    "tags": ["ゼロトラスト", "Never Trust Always Verify", "最小権限", "境界型セキュリティ", "リモートワーク"]
  },
  {
    "questionId": "q-sec-032",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "SIEM",
    "level": 7,
    "question": "SIEM（Security Information and Event Management）の主な機能として、最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "社内の全PCにウイルス対策ソフトを自動配布して更新管理を行う",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "ウイルス対策ソフトの自動配布・更新管理はエンドポイント管理ツール（例：EPP/EDRやMDM）の機能です。SIEMはセキュリティログの収集・分析に特化しており、エンドポイント管理は担当しません。",
          "analogy": "SIEMは各部署からの報告書を集めて不審な動きを分析する「本部の分析チーム」であって、現場で警備員（ウイルス対策ソフト）を配置・管理する役割とは違います。"
        }
      },
      {
        "id": "b",
        "text": "複数のシステムやデバイスからセキュリティログを一元収集し、相関分析によってセキュリティインシデントをリアルタイムで検知する",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "SIEMはファイアウォール、IDS/IPS、サーバ、アプリケーションなど多様なソースからセキュリティログをリアルタイムに収集します。それらのログを横断的に相関分析することで、個々のログでは気づけない攻撃パターン（例：複数サーバへの連続失敗ログイン→横展開の可能性）を検知し、アラートを発します。インシデントの早期発見と対応を支援します。",
          "analogy": "大型ショッピングモールの総合警備センターのようなものです。各店舗・各フロアの防犯カメラ映像（各システムのログ）を一ヶ所に集めて、複数の映像を同時に分析し（相関分析）、一人の怪しい人物が複数の店を回っているパターン（攻撃の連鎖）を早期に気づけるようにします。",
          "deepDive": "SIEMの主要機能は①ログ収集・正規化（異なる形式のログを統一フォーマットに変換）②相関分析（複数ログにまたがるパターン検知）③アラート生成と優先度付け④ダッシュボードによるリアルタイム可視化⑤フォレンジック調査支援（過去ログの検索）⑥コンプライアンスレポーティングです。代表的製品にSplunk、IBM QRadar、Microsoft Sentinelなどがあります。"
        }
      },
      {
        "id": "c",
        "text": "Webアプリケーションへの不正入力（SQLインジェクションなど）をリアルタイムでブロックする",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "Webアプリケーションへの不正入力をリアルタイムでブロックするのはWAF（Webアプリケーションファイアウォール）の役割です。SIEMはログの収集・分析・検知が主な役割であり、通信を直接遮断する機能はありません。",
          "analogy": "SIEMは「分析して報告する」役割で、WAFは「現場で実際に防ぐ」役割です。どちらも重要ですが、担当が違います。"
        }
      },
      {
        "id": "d",
        "text": "ユーザーのパスワードを定期的にリセットして強制変更を促す",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "パスワードの定期リセットや強制変更はIDM（ID管理システム）やActive DirectoryのグループポリシーなどIAM（Identity and Access Management）の機能です。SIEMはアカウント管理を直接行いません。",
          "analogy": "監視センター（SIEM）は「誰かが不審なログインを繰り返している」と報告できますが、パスワードを変えに行くのは別の担当者（IAM）の仕事です。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "SIEMは複数システムからのセキュリティログを一元収集し、相関分析によってセキュリティインシデントをリアルタイムに検知するシステムです。個々のログでは見えない攻撃パターンを可視化し、インシデント対応を支援します。",
      "keyPoint": "SIEM＝ログの一元収集＋相関分析＋リアルタイムインシデント検知",
      "relatedTopics": ["SOC（セキュリティオペレーションセンター）", "IDS/IPS", "フォレンジック", "ログ管理", "WAF"],
      "studyTip": "SIEMはSOC（セキュリティ運用センター）の中核ツールです。「S＝Security情報」と「E＝イベント管理」の2つが合わさったシステムと覚えましょう。"
    },
    "tags": ["SIEM", "ログ管理", "相関分析", "セキュリティ監視", "SOC"]
  },
  {
    "questionId": "q-sec-033",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "ペネトレーションテスト",
    "level": 7,
    "question": "ペネトレーションテスト（侵入テスト）に関する記述として、最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "対象システムのソースコードを解析して、プログラムの論理的な欠陥を探す手法である",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "ソースコードを解析してバグや欠陥を見つける手法は「静的解析」や「コードレビュー」と呼ばれます。ペネトレーションテストは実際のシステムに対して攻撃を試みる動的なテスト手法であり、ソースコードの解析とは異なります。",
          "analogy": "設計図（ソースコード）を分析するのと、実際に建物に入ろうとしてみる（侵入テスト）のは全く別の作業です。"
        }
      },
      {
        "id": "b",
        "text": "実際の攻撃者と同じ手法を用いてシステムへの侵入を試み、脆弱性を実証的に確認するセキュリティテスト手法である",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "ペネトレーションテストは、セキュリティ専門家（ペネトレーションテスター、俗にペンテスターと呼ばれる）が攻撃者と同じツールや手法を使ってシステムへの侵入を実際に試みるテストです。脆弱性スキャンが「弱点のリストアップ」であるのに対し、ペネトレーションテストは「実際にその弱点を突いて侵入できるかどうかを実証する」ことが特徴です。",
          "analogy": "建物のセキュリティを確認するために、正式に依頼された専門家が実際に「不法侵入を試みる」ようなものです。鍵穴を確認するのではなく、本当にピッキングできるかを試します。成功すれば「本物の泥棒でも入れる」という実証的な証拠になります。",
          "deepDive": "ペネトレーションテストのアプローチには①ブラックボックステスト（情報なしで攻撃者視点で実施）②グレーボックステスト（一部の情報を与えて実施）③ホワイトボックステスト（全情報を共有して実施）があります。テストフェーズは「情報収集→スキャン→脆弱性の悪用→権限昇格→横展開→報告」です。ETICKなどの倫理的ハッキングの資格（CEH、OSCP）を持つ専門家が実施します。"
        }
      },
      {
        "id": "c",
        "text": "社員がフィッシングメールに騙されるかどうかを定期的にテストする、意識向上のための訓練手法である",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "社員に模擬フィッシングメールを送って意識向上を図る手法は「フィッシングシミュレーション」や「セキュリティ意識向上トレーニング」と呼ばれます。これはペネトレーションテストの一部として実施されることもありますが、ペネトレーションテストはシステムの技術的な脆弱性を実証する活動がメインです。",
          "analogy": "フィッシング訓練は「社員の人間的な弱点」を確認するもので、ペネトレーションテストは「システムの技術的な弱点」を確認するものです。目的が異なります。"
        }
      },
      {
        "id": "d",
        "text": "システムの全ポートを自動スキャンして、開放されているポートと利用しているサービスを一覧化するツールである",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "ポートスキャンやサービス一覧化は「脆弱性スキャン」ツール（例：Nmap）の機能であり、ペネトレーションテストの準備段階（情報収集フェーズ）で使われる手法の一つです。ペネトレーションテスト全体はこれをはるかに超えた実証的な侵入活動を含みます。",
          "analogy": "ポートスキャンは「建物の窓と扉の場所を地図に書く作業」です。ペネトレーションテストはその後に「実際にその窓を開けて中に入る」ところまで行います。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "ペネトレーションテストは、専門家が攻撃者と同じ手法でシステムへの侵入を実際に試み、脆弱性の存在を実証的に確認するセキュリティテスト手法です。脆弱性スキャンとは異なり「実際に侵入できるか」を確認します。",
      "keyPoint": "ペネトレーションテスト＝攻撃者と同手法で実際に侵入を試み脆弱性を実証する",
      "relatedTopics": ["脆弱性スキャン", "レッドチーム演習", "バグバウンティ", "脆弱性診断"],
      "studyTip": "「脆弱性スキャン（弱点の発見）」と「ペネトレーションテスト（実際に攻撃して実証）」の違いを明確に区別しましょう。ペネトレーションはより能動的・実証的なテストです。"
    },
    "tags": ["ペネトレーションテスト", "侵入テスト", "脆弱性診断", "倫理的ハッキング", "セキュリティテスト"]
  },
  {
    "questionId": "q-sec-034",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "マルウェア解析",
    "level": 7,
    "question": "マルウェア解析において「サンドボックス」を使う目的として、最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "マルウェアのソースコードをリバースエンジニアリングして動作を完全に解明するため",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "ソースコードのリバースエンジニアリングは「静的解析」の手法です。サンドボックスは実際にマルウェアを実行して動的に挙動を観察するための環境であり、ソースコードを解析する手法ではありません。",
          "analogy": "サンドボックスは「実際に爆弾を爆発させて何が起きるか見る」防爆実験室であって、設計図（ソースコード）を読む作業ではありません。"
        }
      },
      {
        "id": "b",
        "text": "隔離された安全な仮想環境でマルウェアを実際に実行し、その振る舞い（通信先・ファイル操作・レジストリ変更など）を安全に観察するため",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "サンドボックスは本番環境から完全に隔離された仮想環境（砂場）です。マルウェアをその中で実際に動作させることで、感染してもホストや本番システムには影響を与えずに、マルウェアの動的な挙動（ファイルの作成・削除、レジストリの変更、外部C&Cサーバとの通信、他プロセスへのインジェクション等）を安全に観察・記録できます。これを動的解析と呼びます。",
          "analogy": "危険な化学物質を安全な実験室（サンドボックス）で実際に反応させて、何が起こるかを観察するのと同じです。防護服（隔離環境）を着ていれば、実際に反応させても研究者（本番システム）は安全です。外に漏れない（外部ネットワークに接続しない）ように気密に管理された部屋で行います。",
          "deepDive": "サンドボックス解析の主な観察対象：①ネットワーク通信（C&Cサーバへの接続、DNSクエリ、HTTPリクエスト）②ファイルシステム操作（作成・削除・暗号化）③レジストリ操作（自動起動設定など）④プロセス操作（他プロセスへのインジェクション）⑤API呼び出し。ただし、高度なマルウェアはサンドボックスを検知して動作を隠す技術（VM検知、遅延実行）を持つものもあります。代表的なサンドボックスツールにCuckooサンドボックス（OSS）があります。"
        }
      },
      {
        "id": "c",
        "text": "マルウェアに感染したコンピュータのディスクイメージを取得して法的証拠として保全するため",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "感染済みコンピュータのディスクイメージを取得・保全するのはデジタルフォレンジックの手法です。サンドボックスはあくまでマルウェアの挙動を事前に安全に解析するための環境であり、証拠保全の手法とは異なります。",
          "analogy": "フォレンジックは「すでに犯罪が起きた後の現場保全」、サンドボックス解析は「発見した不審物（マルウェア）を安全な場所で爆発させて調べる」作業です。目的が異なります。"
        }
      },
      {
        "id": "d",
        "text": "マルウェアを社内ネットワーク上で拡散させ、どこまで被害が広がるかを検証するため",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "サンドボックスは本番環境や実際のネットワークから隔離することで安全を確保する環境です。社内ネットワークでマルウェアを意図的に拡散させることは絶対に行ってはなりません。それはセキュリティ評価ではなく、被害を引き起こす行為です。",
          "analogy": "ウイルスの感染力を試すために実際の街（社内ネットワーク）で放すのは論外です。安全な研究所（サンドボックス）の中だけで実験します。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "サンドボックスは本番環境から隔離された仮想環境で、マルウェアを実際に動作させてその振る舞いを安全に観察・分析するための動的解析手法です。静的解析（ソースコード/バイナリ解析）と組み合わせて使われます。",
      "keyPoint": "サンドボックス＝隔離仮想環境でマルウェアを実行し動的挙動を安全に観察する手法",
      "relatedTopics": ["静的解析", "動的解析", "C&Cサーバ", "フォレンジック", "APT（高度持続的脅威）"],
      "studyTip": "静的解析（コードを読む）と動的解析（実際に動かす）の違いを押さえ、サンドボックスは動的解析のツールと位置付けましょう。"
    },
    "tags": ["サンドボックス", "マルウェア解析", "動的解析", "静的解析", "マルウェア対策"]
  },
  {
    "questionId": "q-sec-035",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "OAuth/OpenID Connect",
    "level": 7,
    "question": "OAuth 2.0とOpenID Connectの違いに関する説明として、最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "OAuth 2.0は認証プロトコルであり、OpenID ConnectはOAuth 2.0を拡張して認可機能を追加したものである",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "説明が逆です。OAuth 2.0は「認可（Authorization）」のためのプロトコルで、ユーザーの代わりにリソースへのアクセス権を委任する仕組みです。OpenID ConnectはOAuth 2.0の上に「認証（Authentication）」機能を追加した仕様です。",
          "analogy": "OAuth 2.0は「Aさんの代わりにBさんがAさんのデータにアクセスしていいか」という許可の仕組みで、認証（本人確認）とは別です。"
        }
      },
      {
        "id": "b",
        "text": "OAuth 2.0はリソースへのアクセス権限の委任（認可）を目的とし、OpenID ConnectはOAuth 2.0の上にユーザー認証機能を追加したプロトコルである",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "OAuth 2.0はサードパーティのアプリケーションがユーザーの代わりにリソース（例：Googleフォトの写真）にアクセスする権限を安全に委任するための認可フレームワークです。「誰であるか（認証）」ではなく「何ができるか（認可）」を扱います。OpenID ConnectはOAuth 2.0を拡張し、IDトークン（JWT）を使ってユーザーの身元（認証情報）をアプリケーションに伝えるプロトコルで、「Googleでログイン」などのソーシャルログインに使われています。",
          "analogy": "OAuth 2.0はホテルのルームキー（特定の部屋だけ開けられるカード）を渡す仕組みです。「あなたが誰か」は確認せずに「この部屋に入る権限」だけを渡します。OpenID ConnectはさらにIDカード（誰であるか）も一緒に提示する仕組みを追加したものです。",
          "deepDive": "OAuth 2.0の主なフロー：①認可コードフロー（最も安全、サーバサイドアプリ向け）②クライアントクレデンシャルフロー（機械間通信向け）③PKCEを使った認可コードフロー（モバイルアプリ・SPA向け）。OpenID ConnectではIDトークンとしてJWT（JSON Web Token）が使われ、sub（サブジェクト：ユーザーID）、iss（発行者）、exp（有効期限）などのクレームが含まれます。UserInfoエンドポイントからユーザーの詳細情報を取得することもできます。"
        }
      },
      {
        "id": "c",
        "text": "OAuth 2.0とOpenID Connectは全く別のプロトコルで、用途も競合しており、どちらか一方を選択する必要がある",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "OpenID ConnectはOAuth 2.0の上に構築された拡張仕様であり、競合関係にはありません。むしろOpenID ConnectはOAuth 2.0を前提として使い、認可（OAuth 2.0）と認証（OpenID Connect）を組み合わせて実現します。",
          "analogy": "スマートフォン（OAuth 2.0）とその上で動く電話アプリ（OpenID Connect）のような関係です。競合ではなく、アプリが基盤の上に追加機能を実現しています。"
        }
      },
      {
        "id": "d",
        "text": "OAuth 2.0はデータの暗号化プロトコルであり、OpenID ConnectはOAuth 2.0に電子署名機能を追加したものである",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "OAuth 2.0もOpenID Connectも暗号化プロトコルではありません。どちらも認可・認証に関するプロトコルです。通信の暗号化は別途TLS（HTTPS）で行います。",
          "analogy": "OAuth 2.0は「どのドアへの鍵を渡すか」を決めるルールであって、鍵自体の素材（暗号化）を定めるものではありません。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "OAuth 2.0は「認可（アクセス権の委任）」のプロトコルで、OpenID ConnectはOAuth 2.0を拡張した「認証（ユーザーの身元確認）」プロトコルです。「Googleでログイン」などのソーシャルログインにはOpenID Connectが使われています。",
      "keyPoint": "OAuth 2.0＝認可（何ができるか）、OpenID Connect＝認証（誰であるか）をOAuth 2.0に追加",
      "relatedTopics": ["JWT（JSON Web Token）", "SAML", "シングルサインオン（SSO）", "フェデレーション認証"],
      "studyTip": "「Authentication（認証）」と「Authorization（認可）」の英語の違いを意識して覚えましょう。AuthNが認証、AuthZが認可です。OAuth 2.0はAuthZ、OpenID ConnectはAuthNを提供します。"
    },
    "tags": ["OAuth 2.0", "OpenID Connect", "認証", "認可", "シングルサインオン", "JWT"]
  },
  {
    "questionId": "q-sec-036",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "暗号アルゴリズム",
    "level": 8,
    "question": "AES、RSA、楕円曲線暗号（ECC）の比較として、最も適切な記述はどれか。",
    "choices": [
      {
        "id": "a",
        "text": "AESは公開鍵暗号方式で最も広く使われており、RSAは共通鍵暗号方式の標準規格である",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "説明が逆です。AESは共通鍵暗号方式の標準規格（NIST標準）であり、RSAは公開鍵暗号方式の代表格です。AES（Advanced Encryption Standard）は対称鍵暗号で、RSA（Rivest-Shamir-Adleman）は非対称鍵暗号です。",
          "analogy": "南京錠（同じ鍵で開け閉め＝AES）と郵便ポスト（公開鍵で投函、秘密鍵で取り出し＝RSA）を入れ替えて説明しているようなものです。"
        }
      },
      {
        "id": "b",
        "text": "AESは共通鍵暗号方式で高速・大量データ向け、RSAは公開鍵暗号方式で鍵交換・署名向け、ECCはRSAと比べて短い鍵長で同等以上の安全性を実現する公開鍵暗号方式である",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "各アルゴリズムの特徴を正確に示しています。①AES：NIST標準の共通鍵ブロック暗号。鍵長128/192/256ビット。高速で大量データの暗号化に適する。②RSA：素因数分解の困難性に基づく公開鍵暗号。鍵長は一般に2048ビット以上が推奨。鍵交換や電子署名に使用。③ECC（楕円曲線暗号）：楕円曲線上の離散対数問題の困難性に基づく公開鍵暗号。RSA 2048ビットと同等の安全性を256ビットの鍵長で実現でき、モバイル・IoT等で有利。",
          "analogy": "AESは電子レンジのように高速で大量の食材（データ）を一気に処理する家電。RSAはもう少し手間はかかるが精密な保管庫の鍵（鍵交換・署名）を作れる工作機械。ECCはRSAと同じ精度の鍵を、より小さな材料（短い鍵長）で作れる最新の工作機械です。",
          "deepDive": "AESのラウンド数はキー長により10/12/14ラウンド。RSAの安全性は素因数分解問題の困難さに依存し、量子コンピュータによるShorのアルゴリズムで理論上解読可能となります。ECCも量子コンピュータに対して脆弱です。NIST（米国標準技術研究所）は現在、量子コンピュータ耐性のある「ポスト量子暗号（PQC）」の標準化を進めており、CRYSTALS-Kyberなどが承認されています。"
        }
      },
      {
        "id": "c",
        "text": "RSAは共通鍵暗号方式の中で最も古い規格であり、現在はすべてAESに置き換えられている",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "RSAは共通鍵暗号方式ではなく公開鍵暗号方式です。また、RSAはデジタル署名やTLS鍵交換において現在も広く使われており、AESに「置き換えられた」という事実もありません。AES（共通鍵）とRSA（公開鍵）は異なる用途で今も共存して使われています。",
          "analogy": "RSAという特殊な金庫用の錠前（公開鍵暗号）と、AESという高速ドアロック（共通鍵暗号）は別々の用途で使われており、どちらかが不要になることはありません。"
        }
      },
      {
        "id": "d",
        "text": "楕円曲線暗号（ECC）はRSAより安全性が低いが、処理速度が速いため組み込み機器で使われる",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "ECCはRSAより安全性が低いのではなく、「より短い鍵長で同等以上の安全性を実現できる」のが特徴です。ECC 256ビットはRSA 3072ビットと同等の安全性を持つとされており、安全性において劣るわけではありません。処理速度の利点は事実ですが、安全性の説明が誤りです。",
          "analogy": "ECCはRSAより弱い素材で作った鍵ではなく、「同じ強度を持つが、より軽くてコンパクトな鍵素材（楕円曲線）」で作ったものです。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "AESは高速な共通鍵暗号（大量データの暗号化向け）、RSAは公開鍵暗号（鍵交換・署名向け）、ECCはRSAより短い鍵長で同等の安全性を実現する公開鍵暗号（モバイル・IoT向け）です。",
      "keyPoint": "AES＝共通鍵・高速、RSA＝公開鍵・素因数分解ベース、ECC＝公開鍵・短鍵長で高安全性",
      "relatedTopics": ["ハイブリッド暗号方式", "TLS", "デジタル署名", "ポスト量子暗号", "NIST"],
      "studyTip": "3つの暗号方式を「方式（共通鍵/公開鍵）」「強み」「主な用途」の3軸で整理した表を作って比較しましょう。"
    },
    "tags": ["AES", "RSA", "楕円曲線暗号", "ECC", "共通鍵暗号", "公開鍵暗号", "暗号アルゴリズム"]
  },
  {
    "questionId": "q-sec-037",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "ハッシュ関数",
    "level": 8,
    "question": "SHA-256などの暗号学的ハッシュ関数が備えるべき性質として、誤っているものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "一方向性：ハッシュ値から元のデータを復元することが計算上不可能である",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "一方向性は暗号学的ハッシュ関数の重要な性質であり、正しい記述です。ハッシュ関数は「元データ→ハッシュ値」への計算は簡単ですが、「ハッシュ値→元データ」への逆算は計算上困難でなければなりません。パスワードの保管などに活用されます。",
          "analogy": "肉をミンチにするのは簡単ですが、ミンチから元の肉の形を復元することは不可能です。これが一方向性です。"
        }
      },
      {
        "id": "b",
        "text": "衝突耐性：異なる入力データから同じハッシュ値が生成される（衝突する）ペアを見つけることが計算上不可能である",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "衝突耐性は暗号学的ハッシュ関数が備えるべき重要な性質であり、正しい記述です。衝突耐性が破られると、デジタル署名の改ざんなどが可能になります（MD5はこれが破られています）。SHA-256は現時点で衝突耐性を保っています。",
          "analogy": "異なる荷物（入力データ）に全く同じ伝票番号（ハッシュ値）が付かないようにすることが衝突耐性です。同じ番号が付くと、荷物の取り違えや改ざんが可能になります。"
        }
      },
      {
        "id": "c",
        "text": "可逆性：ハッシュ値と復号鍵があれば、元のデータを正確に復元できる",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "これが誤りです。ハッシュ関数は「可逆性」を持ちません。ハッシュ関数は不可逆（one-way）であり、ハッシュ値からは元のデータを復元できません。「復号鍵」という概念もハッシュ関数には存在しません（復号鍵があって元データを復元できるのは暗号方式であり、ハッシュ関数ではない）。ハッシュ関数の重要な性質は「一方向性」「衝突耐性」「第二原像計算困難性」です。",
          "analogy": "ハッシュ関数はシュレッダーのようなものです。書類（元データ）をシュレッダーにかけた紙くず（ハッシュ値）から元の書類を復元する鍵（復号鍵）は存在しません。それができるとすればそれは暗号化であって、シュレッダー（ハッシュ）ではありません。",
          "deepDive": "暗号学的ハッシュ関数の3つの重要な性質：①一方向性（Pre-image resistance）：ハッシュ値Hが与えられたとき、H=hash(M)となるMを見つけることが困難。②第二原像計算困難性（Second pre-image resistance）：入力Mとhash(M)が与えられたとき、hash(M')=hash(M)となる別のM'を見つけることが困難。③衝突耐性（Collision resistance）：hash(M)=hash(M')となる任意のペア(M,M')を見つけることが困難。SHA-256の出力は256ビット（32バイト）で、これらの性質を現時点で満たしています。"
        }
      },
      {
        "id": "d",
        "text": "雪崩効果：入力データを1ビットでも変更すると、出力されるハッシュ値が大きく変化する",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "雪崩効果（Avalanche Effect）は暗号学的ハッシュ関数が備えるべき重要な性質であり、正しい記述です。わずかな入力の変化がハッシュ値の大幅な変化をもたらすことで、ハッシュ値からの元データの推測を困難にします。",
          "analogy": "「あ」と「い」という1文字の違いが、指紋（ハッシュ値）では全く異なる模様になるようなものです。少し似た入力でも全く違うハッシュ値になるので、元データを絞り込めません。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "暗号学的ハッシュ関数（SHA-256等）が備えるべき性質は「一方向性」「衝突耐性」「第二原像計算困難性」「雪崩効果」などです。「可逆性（復号鍵で元データを復元できる）」はハッシュ関数の性質ではなく、暗号方式の特性です。",
      "keyPoint": "ハッシュ関数＝不可逆（one-way）。可逆性はない。復号鍵は存在しない。",
      "relatedTopics": ["SHA-256", "MD5", "デジタル署名", "パスワードハッシュ", "HMAC"],
      "studyTip": "「ハッシュ＝不可逆」「暗号＝可逆（復号できる）」という対比で覚えましょう。誤った選択肢に暗号方式の特性（可逆性、復号鍵）が登場したら誤りです。"
    },
    "tags": ["ハッシュ関数", "SHA-256", "一方向性", "衝突耐性", "暗号学的ハッシュ"]
  },
  {
    "questionId": "q-sec-038",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "電子証明書の検証",
    "level": 8,
    "question": "PKI（公開鍵基盤）における電子証明書の検証プロセスで確認する事項として、最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "証明書に記載された公開鍵を使って通信の暗号化強度が十分かを確認する",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "証明書の検証は「この証明書が正規のCAから発行された本物か」「有効期限内か」「失効していないか」を確認するプロセスです。暗号化強度の確認は証明書検証の目的ではなく、TLSのネゴシエーション（使用する暗号スイートの決定）で行われます。",
          "analogy": "身分証の確認は「本物か、有効期限切れでないか、失効していないか」を見るものであって、その身分証のラミネートが十分に丈夫かを確認するものではありません。"
        }
      },
      {
        "id": "b",
        "text": "証明書チェーン（信頼チェーン）の検証、証明書の有効期限、失効状態（CRL/OCSPによる確認）の3点を確認する",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "電子証明書の検証では主に3つを確認します。①証明書チェーン（信頼チェーン）の検証：証明書を発行したCAの証明書が信頼できるルートCAにたどり着けるかを検証します。②有効期限：証明書の有効期間（NotBefore〜NotAfter）内であるかを確認します。③失効状態の確認：CRL（証明書失効リスト）またはOCSP（Online Certificate Status Protocol）を使って、証明書が失効していないかを確認します。これら全てをパスした証明書のみが有効と判断されます。",
          "analogy": "運転免許証の確認と同じです。①発行機関が正規の公安委員会（信頼チェーン）で発行したか②有効期限が切れていないか③（もし制度があれば）失効データベースに登録されていないかを確認します。3つ全てOKなら有効な証明書です。",
          "deepDive": "証明書チェーンの詳細：エンドエンティティ証明書→中間CA証明書→ルートCA証明書と辿り、ルートCA証明書がOSやブラウザの「信頼されたルートCA一覧」に含まれているか確認します。CRLは定期的に更新されるリスト（リアルタイム性に欠ける）、OCSPはリアルタイムで証明書の状態を確認できるプロトコルです。OCSP Staplingを使うと、サーバ側でOCSPレスポンスを取得して証明書に添付し、クライアントのOCSP問い合わせを省略できます。"
        }
      },
      {
        "id": "c",
        "text": "証明書に含まれるサーバの秘密鍵が正しいかどうかをCAに問い合わせて確認する",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "電子証明書には秘密鍵は含まれません。証明書に含まれるのは公開鍵です。また、秘密鍵は秘密にすることが前提であり、CAに問い合わせて確認するような仕組みはありません。秘密鍵の確認は、サーバが証明書に対応する秘密鍵を持っているかをTLSハンドシェイク中に間接的に確認します。",
          "analogy": "身分証（証明書）には公開情報（写真・名前・生年月日）が記載されており、暗証番号（秘密鍵）は書かれていません。身分証で暗証番号の正否は確認しません。"
        }
      },
      {
        "id": "d",
        "text": "証明書の発行コストをCAに確認し、正規ルートで取得されたものか審査する",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "証明書の発行コストを確認するプロセスは証明書検証に存在しません。証明書検証は技術的なプロセスであり、商業的な事項（価格や費用）は確認対象ではありません。",
          "analogy": "パスポートが本物かを確認するとき、そのパスポートの申請費用が正規だったかを調べることはしません。技術的な真正性（透かし・ICチップ）を確認します。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "電子証明書の検証では「信頼チェーンの確認（ルートCAまで辿れるか）」「有効期限の確認」「失効状態の確認（CRL/OCSP）」の3点が基本です。これらが全てパスした証明書のみが有効と判断されます。",
      "keyPoint": "証明書検証の3点＝信頼チェーン（CA）＋有効期限＋失効状態（CRL/OCSP）",
      "relatedTopics": ["PKI", "CA（認証局）", "CRL", "OCSP", "TLS", "ルート証明書"],
      "studyTip": "CRL（リスト型・定期更新）とOCSP（リアルタイム問い合わせ）の違いを押さえましょう。どちらも証明書の「失効確認」の手段です。"
    },
    "tags": ["PKI", "電子証明書", "CA", "CRL", "OCSP", "信頼チェーン", "TLS"]
  },
  {
    "questionId": "q-sec-039",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "セキュリティインシデント対応",
    "level": 8,
    "question": "CSIRT（Computer Security Incident Response Team）の役割と活動として、最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "CSIRTは新しいシステムの設計・開発を行うチームであり、セキュリティ機能を組み込む責任を持つ",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "CSIRTはセキュリティインシデントへの対応を専門とするチームであり、システムの設計・開発を行うチームではありません。システム設計・開発にセキュリティを組み込む活動はDevSecOpsやセキュリティアーキテクトの役割です。",
          "analogy": "CSIRT は「緊急救助隊（インシデント対応）」であって、「建物の設計士（システム設計）」ではありません。"
        }
      },
      {
        "id": "b",
        "text": "CSIRTはセキュリティインシデントの検知・対応・回復・再発防止を担当し、組織内外の関係者と連携してインシデントを管理する専門チームである",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "CSIRTはセキュリティインシデント対応の専門組織です。主な活動は①インシデントの検知・トリアージ（優先度分類）②初動対応（封じ込め、被害の最小化）③原因調査・フォレンジック④システムの回復・復旧⑤再発防止策の立案⑥内外関係者（経営層、法務、広報、監督機関、他組織のCSIRT等）との連携・報告⑦インシデント情報の収集・共有です。NISTのサイバーセキュリティフレームワーク（CSF）では「対応（Respond）」と「回復（Recover）」フェーズを担います。",
          "analogy": "CSIRTは消防署のようなものです。火災（インシデント）が発生したら素早く駆けつけ（検知・初動対応）、消火活動を行い（封じ込め・被害最小化）、鎮火後に出火原因を調査し（フォレンジック）、建物の修復を行い（回復）、防火対策を提言します（再発防止）。また、近隣の消防署や保険会社（外部機関）とも連携します。",
          "deepDive": "CSIRTの種類：①組織内CSIRT（社内専門チーム）②国家CSIRT（日本ではJPCERT/CC）③調整CSIRTと対応CSIRTの分担。CSIRT連携組織：JPCERT/CC（日本）、CERT/CC（米国）、First（国際組織）。インシデント対応フェーズ（NIST SP 800-61）：準備→検知・分析→封じ込め・根絶→回復→事後活動。インシデントレスポンスプレイブックの整備と定期的な訓練（机上演習・実働演習）が重要です。"
        }
      },
      {
        "id": "c",
        "text": "CSIRTは社員のセキュリティ教育・訓練を専門とし、フィッシング対策訓練やセキュリティeラーニングを運営する部門である",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "セキュリティ教育・訓練の運営は主に情報セキュリティ教育担当部門や人事部門が担います。CSIRTはインシデント対応が主業務であり、教育運営を専門とする組織ではありません。ただし、インシデントの経験を教育に還元することはあります。",
          "analogy": "消防署（CSIRT）が防火訓練（セキュリティ教育）に協力することはありますが、消防署の主業務は消火活動（インシデント対応）です。学校の先生（教育担当）と消防士（CSIRT）は別の職業です。"
        }
      },
      {
        "id": "d",
        "text": "CSIRTは組織が購入するセキュリティ製品の評価・選定を担当する調達専門チームである",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "セキュリティ製品の評価・選定はセキュリティアーキテクトやIT調達担当の役割です。CSIRTの主業務はインシデント対応であり、製品調達を専門とする組織ではありません。",
          "analogy": "救急救命士（CSIRT）は緊急時に患者を救うのが仕事であって、病院で使う医療機器の購入担当（調達）ではありません。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "CSIRTはセキュリティインシデントの検知・初動対応・調査・回復・再発防止を担当する専門チームです。組織内外の関係者と連携し、インシデントを体系的に管理します。",
      "keyPoint": "CSIRT＝インシデント対応の専門チーム（検知→封じ込め→調査→回復→再発防止）",
      "relatedTopics": ["JPCERT/CC", "SOC", "インシデントレスポンス", "フォレンジック", "NIST CSF"],
      "studyTip": "CSIRTとSOC（Security Operation Center）の違いも押さえましょう。SOCは常時監視（日常的な監視・検知）、CSIRTはインシデント発生時の対応に特化しています。"
    },
    "tags": ["CSIRT", "インシデントレスポンス", "セキュリティインシデント", "JPCERT", "SOC"]
  },
  {
    "questionId": "q-sec-040",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "フォレンジック",
    "level": 8,
    "question": "デジタルフォレンジックにおける証拠収集で最初に行うべき手順として、最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "まず感染したシステムを再起動して正常状態に戻し、その後にログを収集する",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "再起動は揮発性データ（メモリ上の実行中プロセス、ネットワーク接続情報、暗号化キーなど）を消去してしまいます。フォレンジックでは揮発性の高い証拠から順に収集することが原則であり、再起動はその機会を永久に失わせます。また、攻撃者の痕跡（ログ等）も再起動時に上書きされる可能性があります。",
          "analogy": "犯罪現場（インシデントシステム）を片付けて（再起動）きれいにしてから証拠を集めようとするようなもので、証拠を自ら破壊してしまいます。"
        }
      },
      {
        "id": "b",
        "text": "感染が疑われるシステムのディスク全体をイメージとして複製（フォレンジックコピー）し、複製の完全性を保証するためにハッシュ値を記録する",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "ディスクのフォレンジックコピーは正しい手順の一つですが、揮発性データ（メモリ上の情報）を収集する前に実施するのが正しい順序ではありません。メモリ内のデータは電源を切ると失われるため、まず揮発性データを収集し、その後でディスクイメージを取得するのが正しい順序です（揮発性の高いものから収集する原則）。",
          "analogy": "雪の上の足跡（揮発性データ：メモリ）は時間とともに消えてしまうので、まず写真に収め（メモリダンプ）、その後でゆっくり建物内の証拠（ディスク）を記録します。"
        }
      },
      {
        "id": "c",
        "text": "揮発性の高いデータ（メモリ、実行中プロセス、ネットワーク接続）から優先的に収集し、次にディスクイメージをハッシュ値付きで取得する",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "デジタルフォレンジックの証拠収集では「揮発性の高いものから順に収集する（Order of Volatility）」が基本原則です。揮発性順の収集：①CPUレジスタ・キャッシュ→②メインメモリ（RAM）の内容（実行中プロセス、暗号鍵、ネットワーク接続、ログイン中ユーザー等）→③ネットワーク接続・ルーティングテーブル→④ディスクイメージ（揮発性なし・電源断後も保持）。ディスクイメージ取得時は書き込み禁止デバイスを使い、ハッシュ値（SHA-256等）を記録して原本との同一性を証明します。",
          "analogy": "事故現場のガスの漏れ（揮発性データ：メモリ）をまず計測し、その後にゆっくりと建物の構造（ディスク）を調べます。ガス濃度は時間が経つと変化するため、最初に測定します。記録には「この濃度の値は計測時点のもの（ハッシュ値：同一性の証明）」という証拠が必要です。",
          "deepDive": "フォレンジックコピーの厳守事項：①必ずビット単位の完全コピー（ファイルコピーではダメ）を作成②コピー前後に元のメディアのハッシュ値（MD5またはSHA-256）を計算して一致を確認③元のメディアは書き込み禁止ブロッカー経由で接続し、原本を汚染しない④原本は証拠として封印・保管（チェーン・オブ・カストディを記録）⑤調査は必ずコピー（フォレンジックコピー）に対して実施。代表的なフォレンジックツール：EnCase、Autopsy（オープンソース）、Volatility（メモリ解析）。"
        }
      },
      {
        "id": "d",
        "text": "まずマルウェアを除去してシステムをクリーンにしてから、残ったログファイルを証拠として収集する",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "マルウェアを除去するとインシデントの証拠（マルウェア自体、マルウェアが残したファイル、通信ログ等）が消えてしまいます。フォレンジックは「証拠を保全した上で調査を行う」ことが前提であり、証拠を消してから調査することは本末転倒です。まず証拠を収集・保全してから、その後の対処（マルウェア除去・回復）を行います。",
          "analogy": "事件現場（システム）を掃除（マルウェア除去）してきれいにしてから捜査するのは、証拠を自分で捨てることと同じです。まず写真を撮り（フォレンジックコピー）、指紋を採取し（マルウェアの保全）てから、その後に現場を片付けます。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "デジタルフォレンジックでは「揮発性の高いものから順に収集する（Order of Volatility）」が原則です。まずメモリ・プロセス・ネットワーク接続などの揮発性データを収集し、次にハッシュ値付きでディスクイメージを取得します。再起動やマルウェア除去は証拠を破壊するため、収集完了まで行いません。",
      "keyPoint": "フォレンジックの原則＝揮発性順（メモリ→ネットワーク→ディスク）に収集＋ハッシュ値で完全性を証明",
      "relatedTopics": ["CSIRT", "インシデントレスポンス", "Order of Volatility", "チェーン・オブ・カストディ", "メモリダンプ"],
      "studyTip": "「Order of Volatility（揮発性の順序）」というキーワードを覚え、なぜその順序で収集するのかの理由（揮発性データは時間が経つと消える）と合わせて理解しましょう。"
    },
    "tags": ["フォレンジック", "デジタルフォレンジック", "証拠収集", "Order of Volatility", "インシデントレスポンス"]
  }
]
