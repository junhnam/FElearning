[
  {
    "questionId": "q-sec-041",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "サプライチェーン攻撃",
    "level": 9,
    "question": "サプライチェーン攻撃の説明として最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "攻撃対象の組織が直接利用するソフトウェアの脆弱性を突いて侵入する攻撃。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これは一般的な脆弱性悪用攻撃の説明です。サプライチェーン攻撃の特徴は、標的組織を直接攻撃するのではなく、その取引先や開発委託先など「供給連鎖」の弱いリンクを経由する点にあります。",
          "analogy": "銀行の正面玄関を破ろうとするのではなく、銀行に食料を届ける業者のトラックに乗り込んで裏口から入るようなものです。"
        }
      },
      {
        "id": "b",
        "text": "フィッシングメールを大量送信し、認証情報を窃取する攻撃。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これはフィッシング攻撃の説明です。フィッシングは標的に直接メールを送りつける手法であり、サプライチェーン（第三者経由）という概念を含みません。",
          "analogy": "銀行のお客さんに偽のお知らせを送りつけて暗証番号を教えさせようとする詐欺であり、業者経由の侵入とは別の手口です。"
        }
      },
      {
        "id": "c",
        "text": "標的組織が利用するソフトウェアの開発元やサービス提供者を侵害し、その経路を通じて標的組織に悪意あるコードを送り込む攻撃。",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "サプライチェーン攻撃は、標的組織に信頼されている第三者（ソフトウェアベンダー・委託先・部品メーカーなど）を先に侵害し、その信頼関係を悪用して最終標的に到達する攻撃手法です。2020年のSolarWinds事件が代表例で、正規アップデートに悪意あるコードを混入させ数千組織に配布しました。",
          "analogy": "信頼できる業者のトラックを乗っ取り、そのまま工場に納品物として搬入することで、守衛チェックをすり抜けて侵入するようなものです。正規のルートを使うため発見が困難です。",
          "deepDive": "サプライチェーン攻撃への対策として、ソフトウェア部品表（SBOM: Software Bill of Materials）の整備、依存ライブラリの定期監査、コードサイニング証明書の検証、ベンダーへのセキュリティ評価（TPRM: Third Party Risk Management）が重要です。NIST SP 800-161がガイドラインとして参照されます。"
        }
      },
      {
        "id": "d",
        "text": "DNSサーバのキャッシュを汚染し、正規サイトへのアクセスを偽サイトに誘導する攻撃。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これはDNSキャッシュポイズニングの説明です。DNSの仕組みを悪用した攻撃ですが、供給連鎖（第三者ベンダー）を経由するというサプライチェーン攻撃の本質とは異なります。",
          "analogy": "地図アプリの目的地データを書き換えて間違った場所に誘導する手口であり、業者経由の侵入とは別の攻撃です。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "サプライチェーン攻撃は、標的組織に信頼されている第三者（ベンダー・委託先など）を先に侵害し、その信頼関係を踏み台にして最終標的に到達する高度な攻撃手法です。",
      "keyPoint": "標的を直接攻撃するのではなく『信頼された第三者』を経由する点がサプライチェーン攻撃の核心です。",
      "relatedTopics": ["APT攻撃", "SolarWinds事件", "SBOM", "TPRM", "コードサイニング"],
      "studyTip": "SolarWinds事件（2020年）を具体例として押さえると、サプライチェーン攻撃の仕組みと影響範囲が理解しやすくなります。"
    },
    "tags": ["サプライチェーン攻撃", "APT", "SolarWinds", "SBOM", "サードパーティリスク"]
  },
  {
    "questionId": "q-sec-042",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "APT（高度標的型攻撃）",
    "level": 9,
    "question": "APT（Advanced Persistent Threat）の特徴として適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "不特定多数を対象に自動的にマルウェアをばらまく、広域・短期間の攻撃。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これはボットネットやマスメール型マルウェアの特徴です。APTは不特定多数ではなく、特定の組織や個人を対象に長期間にわたって執拗に攻撃を継続する点が特徴です。",
          "analogy": "チラシを大量にポスティングするのはAPTではなく、特定の家の住人だけをターゲットに数ヶ月かけて綿密に情報収集するのがAPTのイメージです。"
        }
      },
      {
        "id": "b",
        "text": "特定の標的組織を対象に、長期間にわたり発見を避けながら持続的に侵害活動を行う高度な攻撃。",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "APTはAdvanced（高度な技術）、Persistent（長期継続）、Threat（脅威）の三要素を持ちます。国家支援型ハッカーグループが代表的な実行者であり、初期侵入後にバックドアを設置して数ヶ月〜数年間にわたって潜伏し、機密情報を窃取し続けます。発見されにくいよう正規ツールを悪用するLiving off the Land（LotL）戦術も特徴です。",
          "analogy": "スパイ映画のように、標的企業の関係者になりすましてじっくり潜入し、発覚しないよう正規の社員のふりをしながら数ヶ月かけて機密文書を少しずつ持ち出すイメージです。",
          "deepDive": "APTグループはMITRE ATT&CKフレームワークで追跡・分類されており、APT28（Fancy Bear）、APT41（Double Dragon）などの名称で知られています。対策としてはEDR（Endpoint Detection and Response）、脅威インテリジェンスの活用、ゼロトラストアーキテクチャが有効です。"
        }
      },
      {
        "id": "c",
        "text": "Webアプリケーションにおいて、悪意あるSQLを入力フォームに注入してデータベースを不正操作する攻撃。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これはSQLインジェクションの説明です。SQLインジェクションはAPTで使われる技術の一つになることはありますが、APT自体の定義（高度・持続的・特定標的）とは異なる概念です。",
          "analogy": "SQLインジェクションは特定の扉を破る道具の一つであり、APTはその道具を含む長期作戦全体のことです。"
        }
      },
      {
        "id": "d",
        "text": "ウイルス対策ソフトの定義ファイルを最新に保つことで完全に防御できる攻撃。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "APTは未知の脆弱性（ゼロデイ）や正規ツールの悪用、カスタムマルウェアを使用するため、ウイルス対策ソフトの定義ファイル更新だけでは防御できません。多層防御と継続的な脅威監視が必要です。",
          "analogy": "既知の犯罪者リストを更新するだけでは、リストに載っていない高度なスパイは防げません。行動パターンの監視や内部の怪しい動きの検出が必要です。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "APTは特定組織を標的に、高度な技術を用いて長期間潜伏しながら継続的に攻撃する脅威です。国家支援型グループが主な実行者です。",
      "keyPoint": "Advanced（高度）＋Persistent（持続的）＋Threat（脅威）。長期潜伏と発見回避がAPTの本質です。",
      "relatedTopics": ["サイバーキルチェーン", "MITRE ATT&CK", "EDR", "ゼロトラスト", "脅威インテリジェンス"],
      "studyTip": "APTの「P（Persistent＝持続的）」に注目しましょう。一時的な攻撃ではなく、数ヶ月〜数年単位の長期作戦であることが最大の特徴です。"
    },
    "tags": ["APT", "標的型攻撃", "持続的脅威", "LotL", "EDR"]
  },
  {
    "questionId": "q-sec-043",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "量子暗号",
    "level": 9,
    "question": "量子鍵配送（QKD: Quantum Key Distribution）の安全性の根拠として最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "鍵の長さが256ビット以上であれば計算量的に解読不可能であるという数学的性質。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これは古典暗号（AES-256等）の安全性の根拠です。量子鍵配送の安全性は鍵の長さや計算量理論ではなく、量子力学の物理法則そのものに基づいています。",
          "analogy": "金庫の頑丈さ（計算量）で守るのが古典暗号で、量子暗号は「鍵を覗いた瞬間に鍵が変化する」という物理法則で守るイメージです。"
        }
      },
      {
        "id": "b",
        "text": "素因数分解問題の計算量的困難性に依存した安全性。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これはRSA暗号の安全性の根拠です。RSAは量子コンピュータのShorのアルゴリズムで破られる可能性があります。QKDは素因数分解とは無関係の物理法則を根拠とします。",
          "analogy": "RSAは「この難問を解くのは時間がかかる」という計算の難しさに頼っていますが、QKDはそれとは全く別の物理の法則に依存しています。"
        }
      },
      {
        "id": "c",
        "text": "量子状態は観測すると変化するという量子力学の原理により、盗聴行為が必ず痕跡を残すこと。",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "QKDは「量子状態の観測は必ず状態を乱す」という量子力学の不確定性原理と量子複製不可能定理（No-cloning theorem）に基づいています。盗聴者が量子ビット（光子等）を観測・コピーしようとすると量子状態が変化し、通信当事者が統計的に盗聴を検出できます。これは数学的な困難性ではなく物理法則による情報理論的安全性です。",
          "analogy": "封蝋を破らずに手紙の内容を読もうとすると封蝋が必ず変形してしまうようなものです。観察するという行為自体が証拠を残すため、盗聴を隠すことが物理的に不可能です。",
          "deepDive": "BB84プロトコルが代表的なQKDプロトコルです。光子の偏光状態を使って鍵を配送し、盗聴検出後に安全な部分のみを鍵として使用します。QKDは鍵配送の問題を解決しますが、通信路の認証や大量データ暗号化は従来の方法と組み合わせる必要があります。現在は東芝・NTT等が実用化研究を進めています。"
        }
      },
      {
        "id": "d",
        "text": "一度使用したら破棄する使い捨て鍵（OTP）を利用することで解読を不可能にする仕組み。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "ワンタイムパッド（OTP）は情報理論的に安全な暗号方式ですが、QKDの安全性の根拠の説明ではありません。QKDはOTPの鍵配送問題を解決する手段として使われることはありますが、安全性の根拠は量子力学の観測原理にあります。",
          "analogy": "OTPは「一度しか使わない完璧な錠前」ですが、QKDはその錠前の鍵を物理法則で守って安全に渡す仕組みです。両者は別の概念です。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "QKDの安全性は計算量的困難性ではなく、量子力学の物理法則（観測による状態変化）に基づきます。盗聴を試みると必ず痕跡が残るため、情報理論的安全性が成立します。",
      "keyPoint": "量子暗号の安全性 = 量子力学の物理法則（観測で状態が変化する）に基づく情報理論的安全性。",
      "relatedTopics": ["BB84プロトコル", "不確定性原理", "量子複製不可能定理", "耐量子暗号", "OTP"],
      "studyTip": "「観測すると変化する」という量子力学の特性が、なぜ盗聴検出につながるかを因果関係で理解しましょう。"
    },
    "tags": ["量子暗号", "QKD", "BB84", "量子力学", "情報理論的安全性", "不確定性原理"]
  },
  {
    "questionId": "q-sec-044",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "ブロックチェーンのセキュリティ",
    "level": 9,
    "question": "パブリックブロックチェーンの改ざん耐性を支える仕組みとして最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "中央管理者が全トランザクションを監査し、不正を検出して排除する仕組み。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "パブリックブロックチェーンは中央管理者を持たない分散型システムです。中央管理者による監査は、従来の中央集権型データベースの仕組みであり、ブロックチェーンの特性とは異なります。",
          "analogy": "銀行が帳簿を管理するのが中央集権型で、ブロックチェーンは世界中の参加者全員が同じ帳簿を持ち合って互いに監視し合うイメージです。"
        }
      },
      {
        "id": "b",
        "text": "各ブロックに前のブロックのハッシュ値を含めることで鎖状に連結し、多数ノードが同一チェーンを保持するため過去データの改ざんが計算量的に困難になる仕組み。",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "各ブロックには「前のブロックのハッシュ値」が含まれているため、あるブロックのデータを改ざんするとそのブロックのハッシュ値が変わり、以降のすべてのブロックを再計算する必要が生じます。さらに、ネットワーク上の多数ノード（51%以上）の同意（コンセンサス）が必要なため、攻撃には膨大な計算資源が必要になります。これがProof of Work等のコンセンサスアルゴリズムによる改ざん耐性です。",
          "analogy": "ページ番号の代わりに「前のページの内容をまとめた暗号コード」を各ページに書いた帳簿のようなものです。一か所を書き換えると以降のページのコードが全部ずれてしまい、かつ世界中に配られた帳簿の全コピーを書き換えないと誰も信用しません。",
          "deepDive": "51%攻撃はネットワーク全体の過半数の計算資源を掌握することで改ざんを可能にする攻撃です。Bitcoin等の大規模ネットワークでは実現困難ですが、小規模なチェーンでは現実的なリスクになります。また、スマートコントラクトのバグ（例：The DAO事件）も重要なセキュリティリスクです。"
        }
      },
      {
        "id": "c",
        "text": "AES-256による強力な暗号化で全データを保護し、秘密鍵を持つ者だけがデータを参照できる仕組み。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "パブリックブロックチェーンのデータは一般に公開されており、AES等で全体を暗号化して秘密にする仕組みではありません。改ざん耐性はハッシュ関数による連結とコンセンサスメカニズムによって実現されます。",
          "analogy": "公開台帳なので誰でも内容を見られますが、書き換えることは極めて困難という特性があります。金庫に隠すのではなく、改ざんを透明にして発覚させる仕組みです。"
        }
      },
      {
        "id": "d",
        "text": "定期的なバックアップとスナップショット取得により、改ざん検出時に元のデータに復元できる仕組み。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これは一般的なデータバックアップ・リカバリの説明です。ブロックチェーンの改ざん耐性は、バックアップからの復元ではなく、改ざん自体を計算量的に実行困難にする設計によって実現されています。",
          "analogy": "バックアップは「書き換えられたら元に戻す」仕組みですが、ブロックチェーンは「そもそも書き換えることが物理的・計算量的に極めて困難」な設計です。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "ブロックチェーンの改ざん耐性は、前ブロックのハッシュ値の連結（チェーン構造）と多数ノードによるコンセンサスの組み合わせによって実現されます。",
      "keyPoint": "改ざん耐性の鍵 = ハッシュ値チェーン＋分散コンセンサス（過半数の合意が必要）。",
      "relatedTopics": ["ハッシュ関数", "Proof of Work", "Proof of Stake", "51%攻撃", "スマートコントラクト"],
      "studyTip": "「なぜ過去のブロックを改ざんするのが難しいか」を、ハッシュ値の連鎖という仕組みから論理的に追ってみましょう。"
    },
    "tags": ["ブロックチェーン", "ハッシュ関数", "コンセンサス", "51%攻撃", "Proof of Work", "改ざん耐性"]
  },
  {
    "questionId": "q-sec-045",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "サイバーキルチェーン",
    "level": 9,
    "question": "ロッキード・マーティンが提唱したサイバーキルチェーンにおける、攻撃者の最初の段階として正しいものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "エクスプロイテーション（Exploitation）：脆弱性を悪用してコードを実行する段階。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "エクスプロイテーションはサイバーキルチェーンの第3段階です。攻撃者はこの段階に到達する前に、偵察・武器化を行う必要があります。",
          "analogy": "家に侵入しようとする泥棒が、まず周辺を下見して（偵察）侵入道具を用意してから（武器化）、実際に鍵を開けにかかる（エクスプロイテーション）という順序です。"
        }
      },
      {
        "id": "b",
        "text": "偵察（Reconnaissance）：標的の情報収集を行う段階。",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "サイバーキルチェーンは7段階で構成され、第1段階が偵察（Reconnaissance）です。攻撃者はOSINT（公開情報情報収集）、ドメイン情報、メールアドレス、組織構造、使用技術などを調査します。その後、武器化→デリバリ→エクスプロイテーション→インストール→C2確立→最終目標実行と続きます。偵察段階での検知・対策が最もコストパフォーマンスが高い防御ポイントです。",
          "analogy": "映画の強盗が実行前に銀行の警備員の交代時間・カメラの位置・金庫の種類を何週間もかけて調べるフェーズです。このフェーズで発覚すれば計画全体を阻止できます。",
          "deepDive": "サイバーキルチェーンの7段階：①偵察 ②武器化（Weaponization）③デリバリ（Delivery）④エクスプロイテーション ⑤インストール ⑥C2確立（Command & Control）⑦最終目標実行（Actions on Objectives）。各段階に対応した防御策を実装することで、攻撃を早期に遮断できます。"
        }
      },
      {
        "id": "c",
        "text": "インストール（Installation）：バックドアやマルウェアを永続化する段階。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "インストールはサイバーキルチェーンの第5段階です。攻撃者が脆弱性を悪用してコードを実行した後に、永続的なアクセスを確保するためバックドアをインストールします。",
          "analogy": "家に侵入した後、次回のために合鍵を作る（永続化）段階であり、最初の下見（偵察）よりはるかに後の段階です。"
        }
      },
      {
        "id": "d",
        "text": "C2確立（Command & Control）：侵害したシステムを遠隔操作するための通信路を開設する段階。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "C2（Command and Control）確立はサイバーキルチェーンの第6段階です。侵入・バックドア設置の後に行われ、攻撃者が外部から標的システムを遠隔操作するための通信路を確立します。",
          "analogy": "家に侵入し合鍵も作った後、外部からスマートフォンで家電を操作できるよう無線装置を仕掛けるフェーズです。最初の段階ではありません。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "サイバーキルチェーンは攻撃を7段階で整理したフレームワークです。最初の段階は偵察であり、早期段階での検知・遮断が防御効率を最大化します。",
      "keyPoint": "7段階：偵察→武器化→デリバリ→エクスプロイテーション→インストール→C2確立→最終目標実行。",
      "relatedTopics": ["MITRE ATT&CK", "APT", "インシデントレスポンス", "IOC", "脅威インテリジェンス"],
      "studyTip": "7段階を順番に覚え、各段階に対応できる防御策（ファイアウォール・EDR・SIEM等）と結びつけて理解しましょう。"
    },
    "tags": ["サイバーキルチェーン", "偵察", "APT", "インシデントレスポンス", "ロッキード・マーティン"]
  },
  {
    "questionId": "q-sec-046",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "MITRE ATT&CK",
    "level": 9,
    "question": "MITRE ATT&CKフレームワークの説明として最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "ソフトウェアの脆弱性を一意に識別するためのCVE番号体系を管理するデータベース。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "CVE（Common Vulnerabilities and Exposures）はMITREが管理していますが、ATT&CKとは別の取り組みです。CVEは脆弱性の識別番号体系であり、ATT&CKは攻撃者の戦術・技術を分類したナレッジベースです。",
          "analogy": "CVEが「どの建物に弱点があるか」のリストだとすれば、ATT&CKは「侵入者がその弱点をどう利用して何をするか」の行動パターン集です。"
        }
      },
      {
        "id": "b",
        "text": "セキュリティ製品の性能を評価・認証するための国際標準規格。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "セキュリティ製品の評価・認証はCC（Common Criteria）やFIPS 140等が担います。ATT&CKはフレームワークであり、製品認証規格ではありません。",
          "analogy": "製品の品質証明書（認証規格）と、犯罪者の行動パターン辞典（ATT&CK）は全く別のものです。"
        }
      },
      {
        "id": "c",
        "text": "実際のサイバー攻撃で観測された攻撃者の戦術（Tactics）・技術（Techniques）・手順（Procedures）を体系化したナレッジベース。",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "MITRE ATT&CKはAdversarial Tactics, Techniques, and Common Knowledgeの略称で、実際のサイバー攻撃事例から収集したTTP（戦術・技術・手順）を14の戦術カテゴリ（偵察・リソース開発・初期アクセス・実行・永続化・権限昇格・防御回避・認証情報アクセス・発見・横展開・収集・C2・持出し・影響）に分類したナレッジベースです。脅威インテリジェンスやセキュリティ評価・レッドチーム演習に広く活用されています。",
          "analogy": "警察が歴代の犯罪者の手口を「侵入方法」「逃走ルート」「証拠隠滅方法」などのカテゴリで体系的にまとめた犯罪手口辞典のようなものです。これを知ることで、犯人の次の行動を予測して先手を打てます。",
          "deepDive": "ATT&CKはPurple Teaming（レッドチームとブルーチームの協調）に活用され、組織が自分たちの防御力を特定のAPTグループの手口に対して評価できます。各テクニックにはID（例：T1566：フィッシング）が付与され、対応する緩和策・検知策も記載されています。"
        }
      },
      {
        "id": "d",
        "text": "企業のセキュリティポリシーを文書化・標準化するためのISO/IEC国際規格の一つ。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "ISO/IEC 27001等がセキュリティマネジメントシステムの国際規格ですが、MITRE ATT&CKはISOの規格ではなく、MITRE Corporationが作成・公開している攻撃者行動のナレッジベースです。",
          "analogy": "ISOは「工場の品質管理の基準書」、ATT&CKは「敵の戦術手帳」です。目的も出所も全く異なります。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "MITRE ATT&CKは実際の攻撃事例から収集したTTP（戦術・技術・手順）を体系化したナレッジベースで、脅威インテリジェンスや防御評価に活用されます。",
      "keyPoint": "ATT&CK = 攻撃者のTTP（戦術・技術・手順）を体系化したナレッジベース。実際の攻撃観察に基づく。",
      "relatedTopics": ["サイバーキルチェーン", "CTI（脅威インテリジェンス）", "レッドチーム", "APTグループ", "TTP"],
      "studyTip": "MITRE ATT&CKの公式サイト（attack.mitre.org）で実際のフレームワークのマトリクスを確認すると、戦術と技術の関係が視覚的に理解できます。"
    },
    "tags": ["MITRE ATT&CK", "TTP", "脅威インテリジェンス", "サイバーキルチェーン", "APT", "レッドチーム"]
  },
  {
    "questionId": "q-sec-047",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "ランサムウェア対策",
    "level": 9,
    "question": "ランサムウェア攻撃への対策として、技術的観点から最も効果的な組み合わせはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "ウイルス対策ソフトのインストールと、パスワードの定期変更。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "ウイルス対策ソフトとパスワード変更は基本的な対策ですが、現代の高度なランサムウェアはファイルレス技術やLotL（正規ツールの悪用）を使用するため、定義ファイルベースのウイルス対策だけでは不十分です。パスワード変更も定期的な強制変更はむしろ弱いパスワードを生む傾向があります。",
          "analogy": "金庫の番号を定期的に変えるだけでは、壁をくりぬかれたら意味がありません。より多層的な防御が必要です。"
        }
      },
      {
        "id": "b",
        "text": "ネットワーク分離・最小権限の原則・オフライン（エアギャップ）バックアップの組み合わせ。",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "ランサムウェア対策の核心は（1）感染範囲の最小化と（2）確実な復旧手段の確保です。ネットワーク分離（セグメンテーション）は横展開（ラテラルムーブメント）を阻止し、最小権限の原則はランサムウェアがアクセスできるファイルを制限し、オフライン/エアギャップバックアップは暗号化されても復旧できる保険となります。3-2-1バックアップルール（3コピー・2種類のメディア・1つはオフサイト）が標準的な指針です。",
          "analogy": "火災対策で建物を防火壁で区切り（延焼防止）、可燃物を最小限にし（最小権限）、遠くの倉庫に財産のバックアップを保管する（オフラインバックアップ）という組み合わせと同じ考え方です。",
          "deepDive": "ランサムウェアグループは近年、暗号化前にデータを外部に持ち出す二重恐喝（Double Extortion）や、DDoS攻撃を組み合わせた三重恐喝も行います。バックアップがあっても情報漏洩は防げないため、DLP（データ漏洩防止）やEDRによる異常検知も不可欠です。"
        }
      },
      {
        "id": "c",
        "text": "身代金の支払いに備えた仮想通貨の準備と、攻撃者との交渉窓口の設置。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "身代金を支払っても復号鍵が提供されない、または別の攻撃を招くケースが多数報告されています。多くの国のサイバーセキュリティ機関（CISA、FBI等）は身代金の支払いを推奨しておらず、技術的な防御・復旧手段の整備を優先するよう指導しています。",
          "analogy": "泥棒に「次は盗まない」という約束のお金を払うようなもので、払ったからといって守られる保証はなく、むしろ「払う組織」として狙われやすくなります。"
        }
      },
      {
        "id": "d",
        "text": "クラウドストレージへのリアルタイム同期バックアップと、全ファイルの暗号化。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "リアルタイム同期バックアップは、ランサムウェアによる暗号化が即座に同期されてしまうため有効ではありません。全ファイルの暗号化も、すでに暗号化されているファイルを再暗号化するだけで対策にはなりません。オフラインまたはイミュータブル（変更不可）なバックアップが必要です。",
          "analogy": "Dropboxで「ファイルが書き換えられた瞬間に同期」される設定は、ランサムウェアに感染した場合はバックアップ先も同じ暗号化ファイルで上書きされてしまいます。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "ランサムウェア対策の本質は「感染範囲の最小化（分離・最小権限）」と「確実な復旧手段の確保（オフラインバックアップ）」の組み合わせです。",
      "keyPoint": "3-2-1バックアップルール＋ネットワーク分離＋最小権限が基本三原則。リアルタイム同期は対策にならない。",
      "relatedTopics": ["二重恐喝", "EDR", "DLP", "ゼロトラスト", "インシデントレスポンス", "事業継続計画（BCP）"],
      "studyTip": "ランサムウェアは暗号化で「可用性」を侵害し、データ流出で「機密性」も侵害します。対策はCIAのどれを守るためかを意識しながら整理しましょう。"
    },
    "tags": ["ランサムウェア", "バックアップ", "最小権限", "ネットワーク分離", "二重恐喝", "3-2-1ルール"]
  },
  {
    "questionId": "q-sec-048",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "バッファオーバーフロー攻撃",
    "level": 9,
    "question": "バッファオーバーフロー攻撃が成立する根本的な原因として最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "Webアプリケーションのデータベースクエリに悪意あるSQLが注入されるから。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これはSQLインジェクションの原因の説明です。バッファオーバーフローはメモリ管理の問題であり、データベースとは関係ありません。",
          "analogy": "SQLインジェクションは「注文書に余計な命令を書き込む」問題で、バッファオーバーフローは「容量オーバーの荷物で棚を破壊する」全く別の問題です。"
        }
      },
      {
        "id": "b",
        "text": "プログラムが入力データの長さを検証せずにスタックやヒープ上の固定長バッファに書き込むため、隣接メモリ領域が上書きされるから。",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "バッファオーバーフローは、プログラムが入力サイズを確認せずに固定長バッファへ書き込む際に、バッファの境界を超えて隣接するメモリ（スタックフレームのリターンアドレス等）を上書きすることで発生します。攻撃者はリターンアドレスをシェルコードのアドレスに書き換えることで任意コード実行を実現します。C言語のgets()やstrcpy()等が典型的な脆弱関数です。",
          "analogy": "10文字分の枠しかない棚に30文字分の荷物を詰め込もうとすると、隣の棚まではみ出してしまうようなものです。そのはみ出した部分に攻撃コードを仕込まれると、プログラムの実行経路を乗っ取れます。",
          "deepDive": "対策としては、（1）安全な関数の使用（strncpy、snprintf等）、（2）ASLR（アドレス空間配置ランダム化）、（3）DEP/NX（データ実行防止）、（4）スタックカナリア（GCCの-fstack-protectorオプション）、（5）境界チェック付きコンパイラオプションが有効です。また、ROP（Return Oriented Programming）はDEPを回避する高度なバッファオーバーフロー変種です。"
        }
      },
      {
        "id": "c",
        "text": "OSのカーネルに権限の検証機能がなく、一般ユーザーが管理者権限のAPIを直接呼び出せるから。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これは権限昇格脆弱性の説明です。バッファオーバーフローはメモリの境界外書き込みの問題であり、OS権限管理の欠如とは異なります。ただし、バッファオーバーフローが権限昇格につながることはあります。",
          "analogy": "警備員がいないから管理者エリアに入れる（権限管理の欠如）のと、壁の耐荷重を超えて壁が崩れたから入れる（バッファオーバーフロー）は別のメカニズムです。"
        }
      },
      {
        "id": "d",
        "text": "ネットワーク通信の暗号化が不十分なため、通信内容を盗聴・改ざんされるから。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これは盗聴・中間者攻撃の説明です。バッファオーバーフローはネットワーク暗号化とは無関係な、プログラムのメモリ管理の問題です。",
          "analogy": "電話の傍受（盗聴）と、電話機のスピーカーに過大な音を入れて機器を壊す（バッファオーバーフロー）は全く別の問題です。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "バッファオーバーフローはプログラムが入力長の検証を怠り、固定長バッファの境界を超えて隣接メモリを上書きすることで発生します。任意コード実行につながる深刻な脆弱性です。",
      "keyPoint": "入力長の未検証＋固定長バッファ→境界外書き込み→リターンアドレス上書き→任意コード実行。",
      "relatedTopics": ["ASLR", "DEP/NX", "スタックカナリア", "ROP", "メモリセーフ言語（Rust）", "gets()/strcpy()の危険性"],
      "studyTip": "バッファオーバーフローは「容量を超えたら隣にはみ出す」という物理的なイメージで理解し、その隣がリターンアドレスというスタック構造を押さえましょう。"
    },
    "tags": ["バッファオーバーフロー", "メモリ安全性", "ASLR", "DEP", "スタックカナリア", "ROP", "任意コード実行"]
  },
  {
    "questionId": "q-sec-049",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "暗号の数学的安全性",
    "level": 10,
    "question": "楕円曲線暗号（ECC）がRSAと同等の安全性をより短い鍵長で実現できる理由として最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "楕円曲線上の演算処理がRSAより高速なCPU命令セットを利用できるから。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "処理速度の問題ではなく、鍵長の差は安全性の根拠となる数学問題の困難性の差に由来します。楕円曲線離散対数問題（ECDLP）は、整数の離散対数問題や素因数分解問題と比べて、既知のアルゴリズムが格段に非効率なため、より短い鍵長で同等の安全性を達成できます。",
          "analogy": "金庫を開ける道具（アルゴリズム）が特定の素材（数学問題）に対してほとんど効かない場合、より薄い素材（短い鍵）でも十分な防御力を持てるのです。"
        }
      },
      {
        "id": "b",
        "text": "楕円曲線離散対数問題（ECDLP）が整数の素因数分解問題（RSA）や離散対数問題（DLP）と比べて、既知の高速解法アルゴリズムが存在しないため。",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "RSAの安全性は素因数分解（NFS等の準指数時間アルゴリズムが存在）、DHの安全性は離散対数問題に依存しますが、ECDLPに対しては現時点で指数時間を要する一般アルゴリズムしか知られていません。この困難性の差により、128ビットの安全性を得るのにRSAは3072ビット鍵が必要なのに対し、ECCは256ビット鍵で十分です。鍵が短いほど演算コストが下がり、IoT等の資源制約環境でも利用可能になります。",
          "analogy": "RSAの金庫はあるツール（NFS）でゆっくりだが確実に開けられるため、開けにくくするには分厚くする必要があります。ECCの金庫はどんなツールも全く歯が立たないため（既知の高速解法なし）、薄くても十分な防御力を持てるのです。",
          "deepDive": "NIST推奨鍵長の比較：RSA-3072 ≒ DH-3072 ≒ ECC-256（128ビット安全性）。ECCは署名（ECDSA）・鍵交換（ECDH）・鍵カプセル化（ECIES）に使用されます。ただし量子コンピュータのGrovesアルゴリズムはECCの安全性を半減させるため、後量子暗号（CRYSTALS-Kyber等）への移行も進んでいます。"
        }
      },
      {
        "id": "c",
        "text": "楕円曲線は有限体上の点の数が常にRSAモジュラスより少ないため、鍵空間が小さくても安全だから。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これは誤りです。鍵空間が小さいほど安全性が下がるのが一般的です。ECCの強みは鍵空間の大きさではなく、ECDLPの困難性にあります。256ビットのECC鍵でも鍵空間は2^256通りと非常に大きく、安全性の根拠はその解探索の計算困難性です。",
          "analogy": "金庫の強さは鍵の種類数（鍵空間）だけで決まるのではなく、鍵の複製や錠前の解析がいかに難しいかにもよります。ECCは鍵空間より解析の困難性が突出しています。"
        }
      },
      {
        "id": "d",
        "text": "楕円曲線を用いることでハッシュ関数との組み合わせが可能になり、ハッシュの衝突耐性が暗号全体の安全性を高めるから。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "ハッシュ関数との組み合わせはECCに限らずRSAでも行われます（例：RSA-PSS、ECDSA共にハッシュを使用）。ECCの短い鍵長の根拠はハッシュ関数との組み合わせではなく、ECDLPの数学的困難性にあります。",
          "analogy": "RSAもECCも同じ種類の「印鑑（ハッシュ）」を使います。金庫の強さの違いは印鑑の種類ではなく、金庫自体の素材（数学問題の困難性）の差です。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "ECCがより短い鍵長で同等の安全性を実現できるのは、楕円曲線離散対数問題（ECDLP）が既知アルゴリズムに対して素因数分解問題より格段に困難だからです。",
      "keyPoint": "ECC-256 ≒ RSA-3072（128ビット安全性）。ECDLPに高速解法が存在しないことが鍵長短縮の根拠。",
      "relatedTopics": ["ECDSA", "ECDH", "後量子暗号", "CRYSTALS-Kyber", "NIST推奨鍵長", "素因数分解問題"],
      "studyTip": "RSA・ECC・後量子暗号それぞれの安全性の根拠となる数学問題（素因数分解・ECDLP・格子問題等）を対比して整理しましょう。"
    },
    "tags": ["楕円曲線暗号", "ECC", "ECDLP", "RSA", "鍵長", "数学的安全性", "後量子暗号"]
  },
  {
    "questionId": "q-sec-050",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "ゼロ知識証明",
    "level": 10,
    "question": "ゼロ知識証明（Zero-Knowledge Proof）の説明として最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "ハッシュ関数を用いてパスワードをハッシュ値として保存し、認証時にハッシュ値を比較することでパスワード本体を送信しない技術。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これはパスワードのハッシュ保存（bcrypt等）の説明です。ゼロ知識証明は「ある命題が真であること」を証明しつつ、その証明に使った情報（秘密情報そのもの）を一切相手に漏らさない点がポイントです。ハッシュ保存はゼロ知識証明の特性を持ちません。",
          "analogy": "ハッシュ保存はパスワードを変換して保管するだけであり、「知っていることを証明しつつ中身は一切教えない」というゼロ知識証明の本質とは異なります。"
        }
      },
      {
        "id": "b",
        "text": "秘密情報そのものを開示することなく、その情報を知っていることを数学的に証明できるプロトコル。",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "ゼロ知識証明は「証明者（Prover）が検証者（Verifier）に対して、ある命題が真であることを証明するが、その証明過程で証明に使った秘密情報は一切漏れない」プロトコルです。完全性（真なら証明できる）・健全性（偽なら騙せない）・ゼロ知識性（証明に使った情報は漏れない）の3性質を満たします。ブロックチェーンのプライバシー（ZK-SNARK）や認証システム（パスワードを送らない）に応用されています。",
          "analogy": "「私は宝箱の暗証番号を知っている」ということを、番号そのものを教えずに証明するようなものです。例えば、宝箱を開けて見せるという行為だけで番号を知っていることを証明できますが、相手は番号を知ることができません。",
          "deepDive": "具体的なプロトコルとして、フィアット・シャミール識別プロトコルや、ZK-SNARK（Zero-Knowledge Succinct Non-Interactive Argument of Knowledge）があります。ZK-SNARKはEthereum（ZK-Rollup）やZcashなどのブロックチェーンプロジェクトでプライバシー保護・スケーラビリティ向上に活用されています。"
        }
      },
      {
        "id": "c",
        "text": "送信者と受信者の両方が鍵を知らない状態でも、公開鍵インフラ（PKI）を利用して安全に通信を開始できるプロトコル。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これはDiffie-Hellman鍵交換（DH）の概念に近い説明です。ゼロ知識証明は「秘密を知っていることを秘密を明かさずに証明する」プロトコルであり、「鍵を知らない状態での通信」とは異なります。",
          "analogy": "DHは「お互い暗号の材料だけ交換して共通の鍵を作る」仕組みで、ゼロ知識証明は「鍵を持っていることを鍵を見せずに証明する」仕組みです。関連はしますが別の概念です。"
        }
      },
      {
        "id": "d",
        "text": "ネットワーク上の全通信をゼロに近い遅延で転送するために、暗号化処理を省略するプロトコル。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "「ゼロ知識」の「ゼロ」は遅延や暗号化の省略とは無関係です。「証明過程で漏れる知識がゼロ」という意味です。ゼロ知識証明はむしろ計算量が大きくなることが多く、暗号化の省略とは真逆の方向性です。",
          "analogy": "「ゼロ知識」は「秘密情報の漏洩がゼロ」という意味であり、「遅延ゼロ」や「暗号なし」とは全く関係ありません。言葉の意味を混同しないようにしましょう。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "ゼロ知識証明は秘密情報を開示せずに「その情報を知っている」ことを数学的に証明できるプロトコルで、ブロックチェーンのプライバシーや認証システムに応用されます。",
      "keyPoint": "ゼロ知識証明の三性質：完全性・健全性・ゼロ知識性。秘密を明かさずに知識の所持を証明できる。",
      "relatedTopics": ["ZK-SNARK", "ZK-Rollup", "フィアット・シャミールプロトコル", "ブロックチェーン", "プライバシー強化技術"],
      "studyTip": "「宝箱を開けて見せるが番号は教えない」というアナロジーで基本概念を掴んでから、ZK-SNARKのブロックチェーン応用に進むと理解しやすいです。"
    },
    "tags": ["ゼロ知識証明", "ZKP", "ZK-SNARK", "ブロックチェーン", "プライバシー", "認証"]
  },
  {
    "questionId": "q-sec-051",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "準同型暗号",
    "level": 10,
    "question": "準同型暗号（Homomorphic Encryption）の説明として最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "暗号化されたデータを復号することなく、暗号文のまま演算を行い、その結果を復号すると平文に対して同じ演算を行った結果と等しくなる暗号方式。",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "準同型暗号はEnc(a) op Enc(b) = Enc(a op b)という性質を持ちます（opは演算）。データを暗号化したままクラウドに送り、クラウド側で復号せずに計算（加算や乗算）を行わせることができます。クラウドサービスプロバイダーはデータを見ることなく計算を代行でき、計算結果を受け取った所有者が復号して結果を得ます。医療データ・金融データの機密性を保ちながらのデータ分析に有望な技術です。",
          "analogy": "封筒に入ったまま（暗号化された状態で）数学の計算を行ってもらうようなものです。計算した人は中身（元のデータ）を見ることができず、封筒を開ける（復号する）のは所有者だけです。",
          "deepDive": "部分準同型暗号（Partially HE）は加算または乗算の一方のみをサポート（例：Paillier暗号は加算のみ）、完全準同型暗号（FHE: Fully HE）は任意の演算をサポートします。FHEはGentry（2009年）が初めて実現しましたが、現在も計算コストが高く実用化が課題です。Microsoft SEALやIBM HELibが代表的なFHEライブラリです。"
        }
      },
      {
        "id": "b",
        "text": "異なる暗号アルゴリズムを組み合わせて使用することで、単一アルゴリズムの弱点をカバーするハイブリッド暗号方式。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これはハイブリッド暗号（公開鍵暗号で共通鍵を交換し、実データは共通鍵暗号で保護する方式）の説明です。「準同型」は「同型（同じ演算構造）を保つ」という数学的性質を指す言葉であり、暗号の組み合わせとは無関係です。",
          "analogy": "ハイブリッド暗号は「錠前と金庫を組み合わせて使う」イメージで、準同型暗号は「金庫に入れたまま計算できる」という全く別の性質です。"
        }
      },
      {
        "id": "c",
        "text": "暗号化処理において同一の平文から常に同一の暗号文を生成する決定性暗号方式。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これは決定性暗号（Deterministic Encryption）の説明です。同一平文から同一暗号文を生成する性質はデータベースでの検索に使われることがありますが、準同型暗号の定義である「暗号文のまま演算可能」とは異なります。",
          "analogy": "「同じ材料を入れると常に同じ製品が出る工場（決定性）」と「工場の外から操作して製品を加工できる仕組み（準同型）」は別の特性です。"
        }
      },
      {
        "id": "d",
        "text": "量子コンピュータ上で実行される量子ゲートを用いた暗号演算により、古典的コンピュータでは解読不可能な暗号を実現する方式。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これは量子暗号や量子コンピューティングを用いた暗号の説明です。準同型暗号は古典的なコンピュータ上で動作する暗号方式であり、量子コンピュータとは無関係です。",
          "analogy": "準同型暗号は今すぐ使えるパソコン上の技術で、量子暗号は量子コンピュータを前提とする別分野の技術です。混同しないよう注意が必要です。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "準同型暗号は暗号文のまま演算可能な暗号方式で、データを復号せずにクラウドで計算させることができます。プライバシー保護型データ分析の実現に向けて研究が進んでいます。",
      "keyPoint": "Enc(a op b) = Enc(a) op Enc(b)。暗号化したまま計算できる＝データを見せずに計算を依頼できる。",
      "relatedTopics": ["完全準同型暗号（FHE）", "Paillier暗号", "プライバシー強化技術（PET）", "秘密計算", "ゼロ知識証明"],
      "studyTip": "「封筒に入れたまま計算できる」というアナロジーを核心に据え、どんなユースケース（医療データ分析等）で有効かをセットで覚えましょう。"
    },
    "tags": ["準同型暗号", "FHE", "秘密計算", "プライバシー強化技術", "クラウドセキュリティ", "Paillier暗号"]
  },
  {
    "questionId": "q-sec-052",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "セキュリティアーキテクチャ設計",
    "level": 10,
    "question": "ゼロトラストアーキテクチャ（ZTA）の基本原則として最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "社内ネットワーク（イントラネット）内のトラフィックは信頼できるとみなし、外部からのアクセスのみを厳格に検証する境界型セキュリティモデル。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これは従来の境界型セキュリティ（ペリメーターセキュリティ）モデルの説明です。ゼロトラストはこのモデルの限界（内部侵害・クラウド化・リモートワーク）を解決するために登場した概念であり、「内部だから信頼」という考え方を否定します。",
          "analogy": "従来は「社屋の中に入った人は社員だから信頼する」という考え方でしたが、内部犯行や侵入者がいる可能性を踏まえ、「社屋内でも毎回身分証確認する」のがゼロトラストです。"
        }
      },
      {
        "id": "b",
        "text": "「決して信頼せず、常に検証する（Never Trust, Always Verify）」原則に基づき、ネットワーク位置に依らず全アクセスを継続的に認証・認可する設計思想。",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "ZTAの核心は「Never Trust, Always Verify」で、場所（社内/社外）に関わらず全てのアクセスリクエストに対して認証・認可・暗号化を要求します。NIST SP 800-207で定義されており、（1）全リソースは安全でない場所にあるとみなす、（2）最小権限・最小限のアクセス、（3）継続的な信頼の検証、（4）全セッションの暗号化という原則で構成されます。マイクロセグメンテーション・IDaaS・EDRと組み合わせて実装されます。",
          "analogy": "ホテルでは廊下を歩く人を全員（宿泊客・従業員・清掃員）がルームキーを持っているか確認するのではなく、各部屋のドアが個別に鍵で管理されます。ゼロトラストは「廊下（ネットワーク）を通れる人を信頼せず、各部屋（リソース）への入口で毎回確認する」設計です。",
          "deepDive": "ZTAの実装要素：IDaaS（多要素認証）、マイクロセグメンテーション（ネットワーク分離）、CASB（クラウドアクセス制御）、EDR（エンドポイント監視）、SIEM（ログ集約・分析）、UEBA（ユーザー行動分析）。ゼロトラストは製品ではなく設計思想であり、段階的な移行が現実的です。"
        }
      },
      {
        "id": "c",
        "text": "全通信をVPNで暗号化することで、どこからのアクセスも社内ネットワーク相当の安全性を確保するリモートアクセス設計。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "VPNは従来の境界型セキュリティを延伸する技術であり、「VPN接続＝信頼」という考え方はゼロトラストと相反します。ZTAではVPN接続後も各リソースへのアクセスを個別に検証する必要があります。むしろZTAはVPN依存からの脱却を目指す面もあります。",
          "analogy": "VPNは「秘密のトンネルで社内に繋げれば安全」という考えですが、ZTAはトンネルの中に入っても「あなたは誰？」と毎回確認する仕組みです。"
        }
      },
      {
        "id": "d",
        "text": "全ての情報資産を物理的に隔離されたオフラインシステムで管理し、インターネット接続を排除する高セキュリティ設計。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これはエアギャップ（物理隔離）の説明です。ゼロトラストはインターネット接続やクラウド利用を前提とした上で、場所を問わない継続的な検証で安全性を担保する設計思想です。物理隔離とは異なるアプローチです。",
          "analogy": "エアギャップは「宝箱ごと地下の金庫に閉じ込める」方法で、ゼロトラストは「宝箱を世界中に置いても、触ろうとする人を毎回厳重に確認する」方法です。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "ゼロトラストアーキテクチャは「Never Trust, Always Verify」を原則とし、ネットワーク位置に関わらず全アクセスを継続的に検証するセキュリティ設計思想です。",
      "keyPoint": "ZTA = 「場所で信頼せず、IDとコンテキストで毎回検証する」。NIST SP 800-207が定義。",
      "relatedTopics": ["マイクロセグメンテーション", "IDaaS", "MFA", "CASB", "SASE", "EDR", "UEBA"],
      "studyTip": "ZTAを理解するには、まず「従来の境界型モデルの限界（内部侵害・クラウド・BYOD）」を押さえ、それへの解決策としてZTAを位置づけると整理しやすいです。"
    },
    "tags": ["ゼロトラスト", "ZTA", "Never Trust Always Verify", "マイクロセグメンテーション", "NIST SP 800-207", "セキュリティアーキテクチャ"]
  },
  {
    "questionId": "q-sec-053",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "サイドチャネル攻撃",
    "level": 10,
    "question": "サイドチャネル攻撃の説明として最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "暗号アルゴリズム自体の数学的脆弱性を利用して秘密鍵を解読する攻撃。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "暗号アルゴリズム自体の数学的脆弱性を突く攻撃は「暗号解読（クリプタナリシス）」と呼ばれます。サイドチャネル攻撃はアルゴリズム自体を攻撃するのではなく、実装時の物理的な副作用（消費電力・電磁波・処理時間等）から秘密情報を推測します。",
          "analogy": "暗号解読は「金庫の設計図の欠陥を見つける」アプローチで、サイドチャネル攻撃は「金庫を開けようとしている人の動き・息づかい・表情を観察して暗証番号を推測する」アプローチです。"
        }
      },
      {
        "id": "b",
        "text": "暗号化デバイスの消費電力・電磁波・処理時間・音響等の物理的特性を観測・分析することで、アルゴリズムを攻撃せずに秘密情報を取得する攻撃。",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "サイドチャネル攻撃は暗号アルゴリズムの数学的欠陥ではなく、「実装」の物理的副作用を利用します。代表例：（1）電力解析攻撃（SPA/DPA）：処理内容によって変化する消費電力を観測、（2）タイミング攻撃：処理時間の差から秘密情報を推測（比較演算の時間差等）、（3）電磁波解析：デバイスから漏洩する電磁波を観測、（4）音響解析：キーボード入力音や暗号処理音を録音して解析。数学的に完璧な暗号でも実装が脆弱なら破られます。",
          "analogy": "ATMに暗証番号を入力する際、ボタンの押した音の違いや手の動きを観察して番号を推測するようなものです。ATMのシステム（アルゴリズム）自体は完璧でも、物理的な操作の痕跡（サイドチャネル）が情報を漏らしてしまいます。",
          "deepDive": "対策として、（1）処理時間を一定にする定時実行（Constant-time implementation）、（2）電力消費をランダム化するマスキング技術、（3）ノイズ付加によるSNR低下、（4）物理的シールドによる電磁波遮断が使われます。特に組み込みシステム・ICカード・HSMでは実装レベルの対策が必須です。"
        }
      },
      {
        "id": "c",
        "text": "ネットワークの通信経路上に偽のルータを設置して、正規の通信を傍受・改ざんする中間者攻撃。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これは中間者攻撃（MITM）の説明です。中間者攻撃はネットワーク通信の傍受・改ざんを行いますが、デバイスの物理的特性を観測する「サイドチャネル」とは異なるアプローチです。",
          "analogy": "中間者攻撃は「手紙の配達途中で封筒を開けて読む」行為で、サイドチャネル攻撃は「手紙を書いている人の部屋の外でキーボード音を聞いて内容を推測する」行為です。"
        }
      },
      {
        "id": "d",
        "text": "ブルートフォース法で大量の鍵を試行し、暗号文を解読する計算集約型の攻撃。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これは総当たり（ブルートフォース）攻撃の説明です。ブルートフォースは全ての候補を試すアプローチですが、サイドチャネル攻撃は物理的観測から少量のデータで効率的に秘密情報を絞り込む全く異なる手法です。",
          "analogy": "ブルートフォースは「全ての鍵を順番に試す」方法で、サイドチャネルは「錠前を開けようとしている人の力の入れ方から正しい鍵の形を推測する」方法です。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "サイドチャネル攻撃はアルゴリズムではなく「実装の物理的副作用」（消費電力・時間・電磁波等）から秘密情報を取得する攻撃です。数学的に安全な暗号でも実装次第で破られます。",
      "keyPoint": "サイドチャネル攻撃 = アルゴリズムではなく実装の物理的漏洩（電力・時間・電磁波）を観測して攻撃する。",
      "relatedTopics": ["電力解析攻撃（DPA）", "タイミング攻撃", "定時実行", "マスキング", "ICカードセキュリティ", "HSM"],
      "studyTip": "「どこから情報が漏れるか」の視点で考えると、サイドチャネルとは「計算の副作用（側道）から情報が漏れる」ことを意味していると理解できます。"
    },
    "tags": ["サイドチャネル攻撃", "電力解析", "タイミング攻撃", "DPA", "実装セキュリティ", "ICカード", "HSM"]
  },
  {
    "questionId": "q-sec-054",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "Trusted Computing（TPM）",
    "level": 10,
    "question": "TPM（Trusted Platform Module）の主な機能として最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "ネットワーク通信を暗号化するためのTLS証明書を管理するソフトウェアモジュール。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "TPMはネットワーク通信用のTLS証明書管理ソフトウェアではありません。TPMはコンピュータのマザーボードに搭載される専用のハードウェアチップであり、ハードウェアレベルのセキュリティ機能を提供します。",
          "analogy": "TLS証明書管理ソフトは「デジタル身分証を保管するフォルダアプリ」ですが、TPMは「改ざん耐性のある物理的な金庫チップ」です。"
        }
      },
      {
        "id": "b",
        "text": "ハードウェアレベルで暗号鍵の生成・保護・プラットフォームの完全性測定を行い、改ざん耐性のある信頼の起点（Root of Trust）を提供するセキュリティチップ。",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "TPMはTCG（Trusted Computing Group）が策定した仕様に基づくセキュリティチップです。主要機能：（1）暗号鍵の安全な生成・保護（ソフトウェアからアクセスできないセキュア領域）、（2）PCR（Platform Configuration Register）によるプラットフォームの完全性測定・記録、（3）TPMバインドによる環境変化検出（別PCに移植されると鍵が使えなくなる）、（4）リモートアテステーション（プラットフォームの状態を外部に証明）。Windows BitLockerの鍵保管にも使用されます。",
          "analogy": "パスポートのICチップのようなものです。チップ内に暗証番号（鍵）を格納し、本物のパスポートであること（プラットフォームの完全性）を証明できます。チップを別のパスポートに移植しても使えません（TPMバインド）。",
          "deepDive": "TPM 2.0はTCG仕様の最新版で、RSA・ECC・SHA-256・SHA-384等をサポートします。Measured Boot（起動チェーンの各段階をTPMで測定）とSecure Boot（署名済みブートローダーのみ実行）の組み合わせにより、ルートキット対策が強化されます。Windows 11ではTPM 2.0が必須要件となっています。"
        }
      },
      {
        "id": "c",
        "text": "仮想マシンのハイパーバイザーを保護し、仮想環境間の情報漏洩を防ぐためのCPU拡張機能。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "仮想マシンの分離・保護はIntel VT-x/AMD-VやSEV（Secure Encrypted Virtualization）等のCPU機能が担います。TPMは仮想化専用の機能ではなく、より広範なプラットフォームの信頼性確保を目的としたセキュリティチップです。",
          "analogy": "CPUの仮想化拡張は「マンションの各部屋を完全に分離する設計」であり、TPMは「建物全体が本物の安全な建物かどうかを証明する建物認証書」です。"
        }
      },
      {
        "id": "d",
        "text": "ファイルシステム全体をリアルタイムに暗号化・復号するソフトウェア層で、OSとストレージの間に介在する。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これはFDE（Full Disk Encryption）ソフトウェア層（例：BitLocker、VeraCryptのソフトウェア部分）の説明です。TPMはFDEの暗号鍵を安全に保管する「ハードウェア金庫」として使われますが、ファイルシステムの暗号化・復号処理自体を担うソフトウェア層ではありません。",
          "analogy": "BitLockerでディスクを暗号化する際、暗号化・復号の処理はソフトウェアが行い、TPMはその「暗号化の鍵を厳重に保管する金庫」として機能します。金庫と工場の役割は別です。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "TPMはハードウェアレベルで暗号鍵の保護とプラットフォームの完全性測定を行うセキュリティチップで、Measured Boot・BitLocker・リモートアテステーションの基盤となります。",
      "keyPoint": "TPM = 改ざん耐性のあるハードウェアセキュリティチップ。Root of Trust（信頼の起点）として機能する。",
      "relatedTopics": ["Secure Boot", "Measured Boot", "BitLocker", "リモートアテステーション", "TCG", "PCR", "HSM"],
      "studyTip": "TPMの機能を「鍵の保管」「プラットフォームの完全性証明」「改ざん検出」の3点で整理し、Secure BootやBitLockerとの連携を具体的なシナリオで理解しましょう。"
    },
    "tags": ["TPM", "Trusted Platform Module", "Root of Trust", "Measured Boot", "Secure Boot", "BitLocker", "リモートアテステーション"]
  },
  {
    "questionId": "q-sec-055",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "セキュアブート",
    "level": 10,
    "question": "セキュアブート（Secure Boot）の動作として最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "起動時にディスク全体をスキャンしてマルウェアを検出・除去してからOSを起動する仕組み。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "ディスク全体のマルウェアスキャンは起動後にウイルス対策ソフトが行う処理です。セキュアブートはスキャンではなく、ブートローダーやドライバの「デジタル署名の検証」によって信頼できるソフトウェアのみを起動します。",
          "analogy": "ウイルス対策ソフトのスキャンは「入場後に荷物検査をする」方法で、セキュアブートは「身分証（デジタル署名）が本物かチェックしてから入場を許可する」方法です。"
        }
      },
      {
        "id": "b",
        "text": "起動プロセスの各段階（UEFI・ブートローダー・OSカーネル・ドライバ）で実行されるコードのデジタル署名を検証し、信頼された署名を持つコードのみを実行することでブートキットやルートキットを防ぐ仕組み。",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "セキュアブートはUEFI仕様の機能で、DB（許可された署名の証明書データベース）とDBX（拒否された証明書・ハッシュのデータベース）を使って各段階のコードの署名を検証します。検証に失敗したコードは実行を阻止されます。これにより、OSが起動する前の最も低いレイヤー（MBR・VBR等）に潜むブートキットを防御できます。MicrosoftやAppleの証明書が信頼されており、独自OSを起動する場合は自己署名証明書をDBに登録する必要があります。",
          "analogy": "空港の搭乗ゲートに例えると、搭乗前に全員のパスポート（デジタル署名）を確認し、信頼された発行機関（認証局）のパスポートを持つ人だけが乗れる仕組みです。偽造パスポート（改ざんされたブートローダー）は検出できます。",
          "deepDive": "セキュアブートとMeasured Boot（TPMによる起動チェーンの測定・記録）は補完的な関係です。セキュアブートは「信頼されたコードのみを実行」し、Measured Bootは「実行されたコードを記録して後から検証可能にする」機能です。Linuxディストリビューションはshim（Microsoftに署名されたブートローダー）を経由してセキュアブートに対応しています。"
        }
      },
      {
        "id": "c",
        "text": "OSの起動後にネットワーク接続を確立し、最新のセキュリティパッチをダウンロードしてから業務用アプリケーションを起動する自動更新の仕組み。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これはソフトウェアの自動更新メカニズムの説明です。セキュアブートはOS起動後ではなく、電源投入直後からOSカーネルロードまでの「ブートプロセス」における署名検証の仕組みです。",
          "analogy": "自動更新は「入館後に毎日ワクチン接種を受ける」仕組みで、セキュアブートは「入館しようとする人が本人確認書類（署名）を持っているか入口で確認する」仕組みです。タイミングが全く異なります。"
        }
      },
      {
        "id": "d",
        "text": "ユーザーが設定したBIOSパスワードによってOSの起動を保護し、不正なユーザーのシステムアクセスを防ぐ認証機能。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "BIOSパスワードはユーザー認証による起動保護ですが、セキュアブートはユーザーパスワードではなくブートローダー等のデジタル署名を検証する仕組みです。BIOSパスワードは物理的アクセスがあれば回避できる場合がありますが、セキュアブートはコードの改ざん自体を防ぎます。",
          "analogy": "BIOSパスワードは「ドアに暗証番号をつける」ことであり、セキュアブートは「ドアから入ってくるもの全てが本物の認証済み部品かどうかを確認する」仕組みです。守る対象が異なります。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "セキュアブートはUEFIの機能で、起動プロセスの各段階でデジタル署名を検証し、信頼されたコードのみを実行することでブートキット・ルートキットを防ぎます。",
      "keyPoint": "セキュアブート = 起動チェーン全体のデジタル署名検証。UEFI + DB/DBXデータベースで信頼されたコードのみ実行。",
      "relatedTopics": ["UEFI", "Measured Boot", "TPM", "ブートキット", "ルートキット", "shim", "DB/DBX"],
      "studyTip": "セキュアブートはOSより前の最も低いレイヤーを守る仕組みと理解しましょう。「なぜOSが起動する前に守る必要があるか（OSより前に動く悪意あるコードの存在）」を考えると重要性が見えてきます。"
    },
    "tags": ["セキュアブート", "Secure Boot", "UEFI", "デジタル署名", "ブートキット", "TPM", "Measured Boot"]
  }
]
