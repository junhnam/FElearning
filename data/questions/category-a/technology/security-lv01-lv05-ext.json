[
  {
    "questionId": "q-sec-011",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "パスワード管理",
    "level": 1,
    "question": "安全なパスワード管理に関する説明として、最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "複数のWebサービスで同じパスワードを使い回すと、1つのサービスからパスワードが漏洩しても他のサービスへの影響はない。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "同じパスワードを使い回すと、1つのサービスで漏洩したパスワードが他のサービスへの不正アクセスに利用される「パスワードリスト攻撃」の被害を受けるリスクが高まります。",
          "analogy": "同じ鍵で家・車・職場の扉を開けるようなもの。1本の鍵を複製されたら、すべての場所に侵入される危険があります。"
        }
      },
      {
        "id": "b",
        "text": "パスワードは長く、英大文字・小文字・数字・記号を組み合わせた複雑なものを、サービスごとに異なる文字列で設定するとよい。",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "パスワードの安全性は「長さ」と「複雑さ」と「一意性（使い回しをしないこと）」の3要素で決まります。長く複雑なパスワードはブルートフォース攻撃に強く、サービスごとに変えることでパスワードリスト攻撃を防げます。",
          "analogy": "家の鍵・車の鍵・金庫の鍵がそれぞれ複雑で異なる形状であるのが理想的。同じシンプルな鍵を使い回すのは危険です。",
          "deepDive": "NIST SP 800-63Bでは、長さを最重視し、複雑さの強制ルールよりも長いパスワードを推奨しています。パスワードマネージャーを使うと、複雑で一意なパスワードを安全に管理できます。"
        }
      },
      {
        "id": "c",
        "text": "パスワードは定期的に変更するほど安全になるので、毎日変更することが最善策である。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "頻繁すぎる変更は、ユーザーが覚えやすい単純なパスワード（例：「password1」→「password2」）を選ぶ傾向を生みます。NISTは、漏洩の証拠がない限り定期的な強制変更を非推奨としています。",
          "analogy": "毎日新しい鍵に変えても、簡単に複製できる鍵では意味がありません。複雑な鍵を長く使うほうが安全なこともあります。"
        }
      },
      {
        "id": "d",
        "text": "パスワードをメモ帳に書き留めてパソコンの画面に貼っておくと、忘れる心配がなくなり安全である。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "パスワードをモニターに貼るなど人目に触れる場所に保管することは、ソーシャルエンジニアリングや物理的な盗み見のリスクを高め、非常に危険です。",
          "analogy": "家の鍵を玄関のドアに「これが鍵です」と書いたラベルと一緒に張り付けているようなものです。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "安全なパスワード管理の3原則は「長く」「複雑に」「使い回さない」ことです。",
      "keyPoint": "パスワードリスト攻撃を防ぐために、サービスごとに異なるパスワードを設定することが特に重要です。",
      "relatedTopics": ["ブルートフォース攻撃", "パスワードリスト攻撃", "多要素認証"],
      "studyTip": "基本情報技術者試験では「パスワードの使い回し」が攻撃の前提となる問題が多く出題されます。パスワードリスト攻撃との関係を押さえましょう。"
    },
    "tags": ["パスワード管理", "セキュリティ基礎", "認証"]
  },
  {
    "questionId": "q-sec-012",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "ソーシャルエンジニアリング",
    "level": 1,
    "question": "ソーシャルエンジニアリングの説明として、最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "コンピュータプログラムの脆弱性を突いて、システムへの不正アクセスを行う攻撃手法である。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これはソフトウェアの脆弱性を利用したサイバー攻撃（エクスプロイト）の説明です。ソーシャルエンジニアリングはプログラムではなく人間を標的にします。",
          "analogy": "錠前そのものをピッキングするのではなく、住人をだまして鍵を渡させるのがソーシャルエンジニアリングです。"
        }
      },
      {
        "id": "b",
        "text": "ネットワークを流れるパケットを傍受し、ID・パスワードなどの情報を不正に取得する攻撃手法である。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これはパケットスニッフィング（盗聴）の説明です。技術的な手法であり、ソーシャルエンジニアリングとは異なります。",
          "analogy": "電話回線に盗聴器を仕掛けるのは技術的な攻撃で、電話で「電話会社の者ですが」とだまして情報を聞き出すのがソーシャルエンジニアリングです。"
        }
      },
      {
        "id": "c",
        "text": "人間の心理的な隙や行動の油断につけ込み、機密情報を不正に入手する攻撃手法である。",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "ソーシャルエンジニアリングとは、技術的な手段ではなく「人間」を標的にした攻撃です。なりすまし、口実作り（プリテキスティング）、ショルダーハッキング（のぞき見）などが代表例です。",
          "analogy": "「情シスの田中ですが、セキュリティチェックのためパスワードを教えてください」と電話で言うのが典型例。技術ではなく会話と心理で侵入します。",
          "deepDive": "代表的な手口として、①なりすまし（権威ある人物を装う）、②プリテキスティング（偽の状況を作る）、③ショルダーハッキング（肩越しに盗み見）、④ゴミ箱漁り（トラッシング）があります。"
        }
      },
      {
        "id": "d",
        "text": "Webサイトに大量のリクエストを送りつけ、サービスを停止させる攻撃手法である。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これはDoS攻撃（サービス妨害攻撃）の説明です。システムを技術的に過負荷にする攻撃であり、人間を標的にするソーシャルエンジニアリングとは異なります。",
          "analogy": "お店に大量の電話をかけ続けて業務を妨害するのがDoS攻撃、「保健所の者ですが」とだまして個人情報を聞き出すのがソーシャルエンジニアリングです。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "ソーシャルエンジニアリングは、技術的な手段ではなく人間の心理を利用して情報を盗む攻撃です。",
      "keyPoint": "「技術的ではなく人間を標的にする」という点がソーシャルエンジニアリングの本質です。",
      "relatedTopics": ["フィッシング", "なりすまし", "プリテキスティング", "ショルダーハッキング"],
      "studyTip": "試験では「ソーシャルエンジニアリングの具体例」を問う問題が多いです。なりすまし・ゴミ箱漁り・ショルダーハッキングの3つを特に覚えましょう。"
    },
    "tags": ["ソーシャルエンジニアリング", "セキュリティ基礎", "人的脅威"]
  },
  {
    "questionId": "q-sec-013",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "フィッシング",
    "level": 1,
    "question": "フィッシング（Phishing）攻撃に関する説明として、最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "コンピュータに侵入してファイルを暗号化し、復号と引き換えに金銭を要求する攻撃である。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これはランサムウェアの説明です。フィッシングはマルウェアによるファイル暗号化ではなく、偽サイトへ誘導してID・パスワードを盗む攻撃です。",
          "analogy": "金庫ごと盗んで「返してほしければ身代金を払え」と要求するのがランサムウェア、偽の銀行窓口に誘導して暗証番号を教えさせるのがフィッシングです。"
        }
      },
      {
        "id": "b",
        "text": "正規の組織（銀行・通販サイト等）を装ったメールやSMSで偽サイトへ誘導し、個人情報やID・パスワードを騙し取る攻撃である。",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "フィッシングは「fishing（釣り）」と「sophisticated（洗練された）」を組み合わせた造語で、魚を釣り上げるように被害者をおびき寄せる攻撃です。偽のメールや偽サイトで個人情報やクレデンシャルを騙し取ります。",
          "analogy": "「〇〇銀行です。不審なログインがありました。こちらで確認してください」というメールを送り、そっくりの偽サイトへ誘導。暗証番号を入力させて盗む手口です。",
          "deepDive": "亜種として、特定の組織や個人を狙った「スピアフィッシング」、経営層を狙った「ホエーリング（捕鯨）」、SMSを使った「スミッシング」、音声電話を使った「ビッシング」があります。"
        }
      },
      {
        "id": "c",
        "text": "ネットワーク上の通信を盗聴し、第三者が送受信データを不正に取得する攻撃である。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これは盗聴（スニッフィング）の説明です。フィッシングは通信の盗聴ではなく、被害者を偽サイトに誘導して自ら情報を入力させる攻撃です。",
          "analogy": "盗聴は電話の内容を陰で聞くこと。フィッシングは「偽の受付に電話してもらい、自分からパスワードを言わせる」ことです。"
        }
      },
      {
        "id": "d",
        "text": "Webサーバに悪意あるコードを埋め込み、そのサイトを訪れたすべてのユーザーを感染させる攻撃である。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これはWebサイト改ざんやドライブバイダウンロード攻撃の説明です。フィッシングは正規サイトの改ざんではなく、偽サイトへの誘導が特徴です。",
          "analogy": "本物の駅に爆弾を仕掛けるのが改ざん攻撃、まったく別の場所に本物そっくりの偽の駅を作って人を集めるのがフィッシングです。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "フィッシングは、正規組織を装ったメール等で偽サイトに誘導し、個人情報・認証情報を騙し取る攻撃です。",
      "keyPoint": "「偽サイトへの誘導」と「自ら情報を入力させる」の2点がフィッシングの特徴です。",
      "relatedTopics": ["スピアフィッシング", "スミッシング", "ソーシャルエンジニアリング", "多要素認証"],
      "studyTip": "フィッシングの対策として「URLの確認」「多要素認証の導入」「公式アプリ・ブックマークからのアクセス」が有効です。試験でよく問われます。"
    },
    "tags": ["フィッシング", "セキュリティ基礎", "ソーシャルエンジニアリング"]
  },
  {
    "questionId": "q-sec-014",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "ファイアウォール",
    "level": 2,
    "question": "ファイアウォールの主な機能として、最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "ネットワーク上を流れるすべての通信を暗号化し、第三者による盗聴を防ぐ。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "通信の暗号化はSSL/TLSやVPNの役割です。ファイアウォールの主な目的は通信の「暗号化」ではなく「フィルタリング（許可・遮断）」です。",
          "analogy": "ファイアウォールは入口の警備員。荷物を封筒に入れて見えなくする（暗号化）のは郵便局の役割で、警備員の仕事ではありません。"
        }
      },
      {
        "id": "b",
        "text": "コンピュータウイルスを検出・駆除し、マルウェアからシステムを保護する。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "ウイルスの検出・駆除はアンチウイルスソフトの機能です。ファイアウォールはウイルスそのものを分析するのではなく、通信の可否を判断します。",
          "analogy": "警備員（ファイアウォール）は「招待状を持っているか」で入場を判断し、爆発物探知犬（アンチウイルス）が荷物の中身を調べます。両者は別の役割です。"
        }
      },
      {
        "id": "c",
        "text": "あらかじめ設定されたルールに基づき、ネットワーク間の通信を許可または遮断してアクセスを制御する。",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "ファイアウォールはIPアドレス・ポート番号・プロトコルなどのルールに基づいて通信を「フィルタリング」します。内部ネットワークと外部（インターネット）の境界に設置し、不正なアクセスを遮断します。",
          "analogy": "ビルの入口の警備員のようなもの。「社員証を持っている人だけ入れる」というルールに基づいて通行を許可・拒否します。",
          "deepDive": "ファイアウォールの種類には、①パケットフィルタリング型（IPアドレス・ポート番号でフィルタ）、②ステートフルインスペクション型（通信の状態を追跡）、③アプリケーションゲートウェイ型（プロキシ方式でアプリ層を検査）があります。"
        }
      },
      {
        "id": "d",
        "text": "複数のWebサーバに負荷を分散し、サービスの安定稼働を維持する。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これはロードバランサ（負荷分散装置）の説明です。ファイアウォールは可用性の向上ではなく、不正アクセスの遮断を目的としています。",
          "analogy": "お客さんを複数のレジに振り分けるのがロードバランサ、不審者をビルに入れないのがファイアウォールです。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "ファイアウォールはネットワーク間の境界に設置し、ルールに基づいて通信を許可・遮断するアクセス制御装置です。",
      "keyPoint": "「ルールに基づいた通信のフィルタリング」がファイアウォールの本質です。暗号化やウイルス検出とは別機能です。",
      "relatedTopics": ["DMZ", "パケットフィルタリング", "IDS/IPS", "WAF"],
      "studyTip": "試験では「ファイアウォールだけでは防げないもの（例：暗号化された通信内のウイルス）」という形で出題されることがあります。他のセキュリティ機器との違いを整理しましょう。"
    },
    "tags": ["ファイアウォール", "ネットワークセキュリティ", "アクセス制御"]
  },
  {
    "questionId": "q-sec-015",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "暗号化の基礎",
    "level": 2,
    "question": "共通鍵暗号方式と公開鍵暗号方式の比較として、最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "共通鍵暗号方式は暗号化と復号に異なる鍵を使用し、公開鍵暗号方式は同じ鍵を使用する。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "説明が逆です。共通鍵暗号方式は暗号化と復号に「同じ鍵（共通鍵）」を使い、公開鍵暗号方式は暗号化に「公開鍵」、復号に「秘密鍵」という「異なる鍵のペア」を使います。",
          "analogy": "共通鍵は「合鍵（同じ形の鍵で施錠・開錠）」、公開鍵は「南京錠（誰でも閉められるが開けられるのは鍵を持つ人だけ）」のようなものです。"
        }
      },
      {
        "id": "b",
        "text": "共通鍵暗号方式は処理速度が遅く、大量データの暗号化には公開鍵暗号方式が適している。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "処理速度は逆です。共通鍵暗号方式は演算量が少なく高速なため大量データに向いており、公開鍵暗号方式は複雑な数学的計算を伴うため低速です。",
          "analogy": "共通鍵は手で素早く書けるメモ暗号（高速）、公開鍵は精巧で複雑な暗号錠（安全だが時間がかかる）のイメージです。"
        }
      },
      {
        "id": "c",
        "text": "共通鍵暗号方式は処理が高速だが鍵の配送問題があり、公開鍵暗号方式は処理が低速だが安全に鍵を配送できる。",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "共通鍵暗号方式（AES等）は高速で大量データに向いていますが、送受信者が同じ鍵を事前に安全に共有しなければならない「鍵配送問題」があります。公開鍵暗号方式（RSA等）は低速ですが、公開鍵は誰でも入手でき、復号用の秘密鍵は公開不要なため、鍵配送問題を解決できます。",
          "analogy": "共通鍵は「同じ合鍵を相手に渡す必要がある（渡す途中で盗まれると危険）」という問題があります。公開鍵方式は「南京錠だけを相手に配る。開ける鍵は自分が持ち続ける」ので安全です。",
          "deepDive": "実際の通信（HTTPS等）では両方の長所を組み合わせたハイブリッド暗号方式が使われます。公開鍵暗号で共通鍵を安全に交換し、その後の通信は高速な共通鍵暗号で行います。"
        }
      },
      {
        "id": "d",
        "text": "公開鍵暗号方式では、受信者の秘密鍵で暗号化し、送信者の公開鍵で復号する。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "手順が逆です。公開鍵暗号方式では、「送信者が受信者の公開鍵で暗号化」し、「受信者が自分の秘密鍵で復号」します。秘密鍵で暗号化するのはデジタル署名の用途です。",
          "analogy": "南京錠（公開鍵）は受取人が配り、送る人がそれを使って荷物を施錠（暗号化）します。受取人だけが専用の鍵（秘密鍵）で開ける（復号）ことができます。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "共通鍵は高速・鍵配送問題あり、公開鍵は低速・鍵配送問題なし。実際の通信では両方を組み合わせたハイブリッド方式が使われます。",
      "keyPoint": "「共通鍵=同じ鍵・高速・鍵配送問題あり」「公開鍵=異なる鍵ペア・低速・鍵配送問題なし」の対比を覚えましょう。",
      "relatedTopics": ["AES", "RSA", "ハイブリッド暗号", "デジタル署名", "SSL/TLS"],
      "studyTip": "試験では「なぜハイブリッド暗号を使うのか」という問いに答えられるようにしておきましょう。両方式の長所を組み合わせることが答えです。"
    },
    "tags": ["共通鍵暗号", "公開鍵暗号", "暗号化", "鍵配送問題"]
  },
  {
    "questionId": "q-sec-016",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "デジタル署名",
    "level": 2,
    "question": "デジタル署名の主な目的として、最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "送信するデータを暗号化して、第三者に内容を読まれないようにすること。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "データの機密性（内容の秘匿）を目的とした暗号化は、公開鍵暗号や共通鍵暗号の役割です。デジタル署名の主目的は機密性ではなく「なりすまし防止」と「改ざん検知」です。",
          "analogy": "デジタル署名は手紙を封筒に入れるのではなく、「確かに自分が書いた」という実印と印鑑証明のような役割です。中身を隠すのではなく、本人確認のために使います。"
        }
      },
      {
        "id": "b",
        "text": "送信者の本人確認（なりすまし防止）とデータの改ざん検知を行うこと。",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "デジタル署名は送信者の秘密鍵でメッセージのハッシュ値を暗号化（署名）し、受信者が送信者の公開鍵で復号・照合することで、①送信者が本人であること（認証）と②データが途中で改ざんされていないこと（完全性）を確認できます。",
          "analogy": "契約書に実印で押した印鑑と印鑑証明のようなもの。「確かにあなたが署名した（本人確認）」「後から書き換えられていない（改ざん検知）」の2点を証明します。",
          "deepDive": "デジタル署名の仕組み：①送信者はメッセージのハッシュ値を自分の秘密鍵で暗号化してデジタル署名を作成 ②受信者は署名を送信者の公開鍵で復号してハッシュ値を取り出し、メッセージから計算したハッシュ値と比較 ③一致すれば本人からの改ざんなし確認OK。"
        }
      },
      {
        "id": "c",
        "text": "データを複数のサーバに分散して保存し、可用性を高めること。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "データの分散保存や可用性向上はレプリケーションや負荷分散の役割です。デジタル署名はデータの保存方法とは無関係です。",
          "analogy": "デジタル署名は「書類に署名する」行為であり、「書類をコピーして複数の金庫に保管する」こととは別の話です。"
        }
      },
      {
        "id": "d",
        "text": "通信相手のIPアドレスを偽装して、匿名性を確保すること。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "IPアドレスの偽装やIPスプーフィングは攻撃手法であり、デジタル署名とは無関係です。デジタル署名は匿名性ではなく、むしろ「誰が署名したか」を証明する技術です。",
          "analogy": "デジタル署名は「自分の名前を証明する実名での署名」であり、匿名性とは正反対の概念です。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "デジタル署名は送信者の「秘密鍵で署名・公開鍵で検証」という仕組みで、本人確認と改ざん検知を実現します。",
      "keyPoint": "暗号化（機密性）とデジタル署名（認証・完全性）の目的は異なります。署名では秘密鍵で暗号化し公開鍵で復号（通常と逆）です。",
      "relatedTopics": ["ハッシュ関数", "公開鍵暗号", "PKI", "電子証明書"],
      "studyTip": "「暗号化は受信者の公開鍵」「署名は送信者の秘密鍵」と使う鍵が逆になることを覚えましょう。試験で頻出の区別ポイントです。"
    },
    "tags": ["デジタル署名", "公開鍵暗号", "認証", "完全性"]
  },
  {
    "questionId": "q-sec-017",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "VPN",
    "level": 3,
    "question": "VPN（Virtual Private Network）に関する説明として、最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "インターネット上に仮想の専用線を設けて暗号化された安全な通信路を確立し、遠隔地のネットワーク間を安全に接続する技術である。",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "VPNはインターネット上に暗号化されたトンネル（仮想のパイプ）を構築し、あたかも専用線でつながっているかのような安全な通信を実現します。テレワーク時の社内ネットワークへの安全なアクセスや、拠点間の安全な通信に広く使われます。",
          "analogy": "大通り（インターネット）の中に透明な防弾シールドのチューブを通したようなもの。チューブの中の通信は外から見えず、安全に情報を運べます。",
          "deepDive": "VPNのプロトコルには、IPsec（ネットワーク層で暗号化）、SSL-VPN（TLSを使用、ブラウザから利用可能）、OpenVPN等があります。トンネリングとカプセル化・暗号化を組み合わせて実現します。"
        }
      },
      {
        "id": "b",
        "text": "不正なアクセスを検知して管理者に通知するネットワーク監視システムである。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "不正アクセスの検知と通知はIDS（侵入検知システム）の説明です。VPNは監視ではなく安全な通信路の確立を目的としています。",
          "analogy": "IDSは「不審者を見つけて警報を鳴らす警報システム」、VPNは「外からでも安全に事務所に繋がるための専用通路」です。"
        }
      },
      {
        "id": "c",
        "text": "複数のネットワークをブリッジし、物理的に離れたLANセグメントを1つに統合する技術である。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これはネットワークブリッジやL2スイッチに関する説明です。VPNはセグメントの統合ではなく、暗号化による安全な仮想専用通信路の確立が目的です。",
          "analogy": "ブリッジは「2つの島の間に橋を架けて一つの島にする」こと。VPNは「別々の島にいながら、安全な水中パイプで通信する」イメージです。"
        }
      },
      {
        "id": "d",
        "text": "Webサイトへのアクセスを高速化するために、よく使われるコンテンツを一時的に保存するサービスである。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これはプロキシサーバやCDN（コンテンツデリバリネットワーク）のキャッシュ機能の説明です。VPNは高速化ではなく安全な通信路の確立を目的としています。",
          "analogy": "コンテンツキャッシュは「よく借りる本を図書館の入口近くに置いておく」こと。VPNは「図書館まで安全なシークレットトンネルで移動する」ことです。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "VPNはインターネット上に暗号化されたトンネルを作り、安全な仮想専用通信路を実現する技術です。テレワークや拠点間通信に活用されます。",
      "keyPoint": "「仮想」「専用線」「暗号化」の3キーワードがVPNを理解する鍵です。",
      "relatedTopics": ["IPsec", "SSL-VPN", "トンネリング", "テレワークセキュリティ"],
      "studyTip": "試験ではIPsec-VPNとSSL-VPNの違い（使用するレイヤーや使いやすさ）が問われることがあります。SSL-VPNはブラウザから使えるため導入が容易という特徴を覚えましょう。"
    },
    "tags": ["VPN", "暗号化", "ネットワークセキュリティ", "テレワーク"]
  },
  {
    "questionId": "q-sec-018",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "SSL/TLS",
    "level": 3,
    "question": "SSL/TLSに関する説明として、最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "メールの添付ファイルを暗号化するための専用プロトコルであり、Webブラウザの通信には使用されない。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "SSL/TLSはWebブラウザとWebサーバ間のHTTPS通信で最も広く使われています。メール専用ではなく、FTPやSMTPなど様々なアプリケーション層のプロトコルの下に利用できます。",
          "analogy": "TLSは「安全な封筒」のようなもので、手紙（メール）だけでなく、宅配便（Webブラウジング）や電話（VoIP）など様々な通信を包むことができます。"
        }
      },
      {
        "id": "b",
        "text": "クライアントとサーバ間の通信を暗号化し、データの機密性・完全性と通信相手の認証を実現するプロトコルである。",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "TLS（Transport Layer Security）はSSLの後継プロトコルで、①暗号化（第三者に通信内容を盗み見られない）②完全性（データが改ざんされていないか確認）③認証（サーバが本物であるか確認）の3つを実現します。現在のWebでは主にTLS 1.2/1.3が使われています。",
          "analogy": "HTTPSは「内容が見えない防弾封筒（暗号化）に入れて、確かな郵便局（認証）を通じて、封が切られていないことを確認（完全性）しながら届ける」郵便サービスです。",
          "deepDive": "TLSハンドシェイク：①クライアントがサポートする暗号スイートを提示 ②サーバが証明書を送付 ③クライアントが証明書を検証し共通鍵の材料を交換 ④以降の通信は共通鍵で暗号化。これによりハイブリッド暗号を実現しています。"
        }
      },
      {
        "id": "c",
        "text": "ネットワーク層（IPレイヤー）で動作し、IPパケットを暗号化するプロトコルである。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "IPパケットレベルで暗号化するのはIPsecです。TLSはトランスポート層（TCP）の上で動作するプロトコルです。",
          "analogy": "IPsecは「道路（ネットワーク層）そのものを安全な専用道路に変える」技術、TLSは「アプリケーションが入った宅配便を安全な箱（トランスポート層）に入れる」技術のイメージです。"
        }
      },
      {
        "id": "d",
        "text": "WebサーバのIPアドレスとドメイン名を対応付けるプロトコルであり、通信の暗号化は行わない。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "IPアドレスとドメイン名の対応付けはDNS（Domain Name System）の役割です。TLSの主な役割は名前解決ではなく通信の暗号化と認証です。",
          "analogy": "DNSは「住所録」でドメイン名をIPアドレスに変換する電話帳。TLSは「その住所に届ける荷物を暗号化して、配達先が本物かを確認する」仕組みです。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "TLS（SSL）はWebブラウザとサーバ間などの通信を暗号化し、盗聴・改ざん・なりすましを防ぐプロトコルです。HTTPSはHTTP+TLSです。",
      "keyPoint": "TLSが提供する3つの機能「暗号化（機密性）」「完全性」「認証」を押さえましょう。",
      "relatedTopics": ["HTTPS", "デジタル証明書", "ハイブリッド暗号", "IPsec"],
      "studyTip": "試験では「HTTPSとTLSの関係」や「TLSが実現するセキュリティ機能」が問われます。「TLSは暗号化だけでなく認証も行う」という点を覚えましょう。"
    },
    "tags": ["SSL/TLS", "HTTPS", "暗号化", "認証", "プロトコル"]
  },
  {
    "questionId": "q-sec-019",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "認証技術",
    "level": 3,
    "question": "二要素認証（2FA: Two-Factor Authentication）に関する説明として、最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "ユーザID とパスワードという2種類の情報を使って認証する方式である。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "ユーザIDとパスワードはどちらも「知識情報（知っているもの）」という同じカテゴリに属します。二要素認証は種類の異なる2つの要素を組み合わせることが本質であり、同じ種類の情報を2つ使うだけでは二要素認証になりません。",
          "analogy": "同じ銀行の通帳を2冊持つのは1要素（所有）のまま。通帳（所有）と暗証番号（知識）の組み合わせが2要素です。"
        }
      },
      {
        "id": "b",
        "text": "「知識情報」「所持情報」「生体情報」のうち、異なる種類から2つの要素を組み合わせて認証する方式である。",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "認証の3要素は①知識情報（パスワード・暗証番号等、知っているもの）、②所持情報（スマートフォン・ICカード等、持っているもの）、③生体情報（指紋・顔・虹彩等、なりすましにくいもの）です。これらの異なるカテゴリから2つを組み合わせることで、1つが漏洩しても安全性を保てます。",
          "analogy": "ATMは「キャッシュカード（所持）＋暗証番号（知識）」の組み合わせ。カードだけ盗まれても暗証番号がわからなければ引き出せません。これが二要素認証の強さです。",
          "deepDive": "具体例：①パスワード（知識）＋SMS認証コード（所持）、②パスワード（知識）＋指紋（生体）、③ICカード（所持）＋PINコード（知識）。3種類すべてを使うと「多要素認証（MFA）」と呼びます。"
        }
      },
      {
        "id": "c",
        "text": "2台の認証サーバを用意し、どちらか一方が正常であれば認証できる冗長化された認証方式である。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これは認証サーバの冗長化・可用性向上の話であり、二要素認証とは無関係です。二要素認証は「何を使って認証するか」の話で、「何台のサーバで認証するか」の話ではありません。",
          "analogy": "二要素認証は「パスポート（所持）と顔認証（生体）の2種類で本人確認する」こと。認証ブース（サーバ）が2台あることとは別の話です。"
        }
      },
      {
        "id": "d",
        "text": "パスワードを毎回自動的に変更し、使い捨てのパスワードで認証する方式である。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これはワンタイムパスワード（OTP）の説明です。ワンタイムパスワードは二要素認証の「所持情報」として使われることがありますが、それ自体は二要素認証ではなく、認証要素の1つです。",
          "analogy": "ワンタイムパスワードは「使い捨て合言葉」。これをパスワード（知識）と組み合わせれば二要素認証になりますが、ワンタイムパスワード単独では一要素（知識または所持）認証です。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "二要素認証は「知識・所持・生体」という異なる種類の認証要素を2つ組み合わせることで、セキュリティを大幅に向上させる認証方式です。",
      "keyPoint": "「2種類の同じカテゴリの情報」は二要素認証ではありません。異なるカテゴリから2つを選ぶことが必須です。",
      "relatedTopics": ["多要素認証（MFA）", "ワンタイムパスワード", "生体認証", "シングルサインオン（SSO）"],
      "studyTip": "3つの認証要素（知識・所持・生体）の具体例を3つずつ覚えておきましょう。「パスワード＋SMS認証コード」が最もよく出る二要素認証の例です。"
    },
    "tags": ["二要素認証", "多要素認証", "認証技術", "情報セキュリティ"]
  },
  {
    "questionId": "q-sec-020",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "PKI",
    "level": 4,
    "question": "PKI（Public Key Infrastructure：公開鍵基盤）において、認証局（CA）が発行するデジタル証明書の役割として、最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "Webサーバとクライアント間の通信を暗号化するための共通鍵を配布する。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "デジタル証明書が配布するのは「公開鍵」であり、「共通鍵」ではありません。共通鍵はTLSハンドシェイクの過程でクライアントとサーバが合意して生成するものです。",
          "analogy": "デジタル証明書は「この南京錠（公開鍵）は確かに〇〇銀行のものです」という公証人（CA）の証明書付きの南京錠。中身の暗号化に使う鍵（共通鍵）は別途交換します。"
        }
      },
      {
        "id": "b",
        "text": "公開鍵とその所有者の身元情報を信頼できる第三者機関が結びつけ、公開鍵の正当性を保証する。",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "デジタル証明書には「公開鍵」「所有者の情報（ドメイン名・組織名等）」「認証局のデジタル署名」が含まれます。認証局（CA）が署名することで、「この公開鍵は確かにこの組織・サーバのものです」という信頼性を担保します。PKIはこの信頼の連鎖（トラストチェーン）を管理する仕組みです。",
          "analogy": "パスポートのようなもの。外務省（認証局）が「この顔写真（公開鍵）と名前（所有者情報）はこの人（サーバ）のものに間違いない」と証明・押印した身分証明書です。",
          "deepDive": "PKIの構成要素：①CA（認証局）：証明書を発行・失効させる機関 ②RA（登録局）：利用者の身元確認を行う機関 ③CRL（証明書失効リスト）：失効した証明書の一覧 ④OCSP：証明書の有効性をリアルタイムに確認するプロトコル。"
        }
      },
      {
        "id": "c",
        "text": "ネットワーク上で発生した不正アクセスの証跡を記録し、証拠として保全する。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "不正アクセスの証跡記録と保全は、ログ管理やフォレンジックツールの役割です。デジタル証明書は公開鍵の正当性を証明するものであり、ログ管理とは無関係です。",
          "analogy": "デジタル証明書はIDカードの発行（身元証明）であり、監視カメラ映像の保管（証跡記録）とは全く別の機能です。"
        }
      },
      {
        "id": "d",
        "text": "サーバの脆弱性を自動的にスキャンし、パッチを適用してセキュリティを維持する。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "脆弱性スキャンとパッチ適用は脆弱性管理ツールの役割です。デジタル証明書は公開鍵の正当性を担保するものであり、脆弱性対策とは無関係です。",
          "analogy": "証明書はあくまでも「身分証」であり、「建物の修繕・点検」はまた別の仕事です。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "PKIのデジタル証明書は、認証局（CA）が「公開鍵とその所有者」を結びつけて正当性を保証する電子的な身分証明書です。",
      "keyPoint": "デジタル証明書=「公開鍵の正当性をCAが保証」。CAの署名があることで初めて、その公開鍵が本物の組織のものと信頼できます。",
      "relatedTopics": ["認証局（CA）", "デジタル署名", "CRL", "OCSP", "TLS/HTTPS"],
      "studyTip": "試験では「デジタル証明書に含まれる情報（公開鍵・所有者情報・CAの署名）」や「証明書失効（CRL・OCSP）」に関する問題がよく出ます。"
    },
    "tags": ["PKI", "デジタル証明書", "認証局", "公開鍵基盤"]
  },
  {
    "questionId": "q-sec-021",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "SQLインジェクション",
    "level": 4,
    "question": "SQLインジェクション攻撃の説明として、最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "攻撃者が大量のリクエストをWebサーバに送りつけ、正常なサービス提供を妨害する攻撃である。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これはDoS/DDoS攻撃の説明です。SQLインジェクションは大量のリクエストを送る攻撃ではなく、Webアプリケーションの入力フォームを悪用してデータベースを不正操作する攻撃です。",
          "analogy": "DoS攻撃は店の前に大人数を立たせて客が入れないようにする妨害行為。SQLインジェクションは注文書に細工して「会計ゼロにする」よう指示を混ぜ込む詐欺行為です。"
        }
      },
      {
        "id": "b",
        "text": "Webアプリケーションの入力フォームなどに不正なSQLコードを埋め込み、データベースを不正に操作する攻撃である。",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "SQLインジェクションは、入力値のバリデーションが不十分なWebアプリケーションに対して、SQLの制御文字（シングルクォート等）を含む悪意ある入力を行い、本来とは異なるSQL命令を実行させる攻撃です。個人情報の漏洩・改ざん・削除や認証バイパスが可能になります。",
          "analogy": "注文書に「ラーメン1杯を注文する' OR '1'='1」と書くと、システムが誤解して「全メニューを無料で提供する」という命令を実行してしまうイメージです。",
          "deepDive": "対策：①プリペアドステートメント（パラメータ化クエリ）の使用（最も有効）、②入力値のエスケープ処理、③WAFの導入、④エラーメッセージにDB情報を含めない、⑤最小権限の原則でDBユーザーを設定する。"
        }
      },
      {
        "id": "c",
        "text": "悪意あるスクリプトをWebページに埋め込み、そのページを閲覧したユーザーのブラウザ上でスクリプトを実行させる攻撃である。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これはXSS（クロスサイトスクリプティング）の説明です。SQLインジェクションはデータベースを標的にした攻撃であり、ブラウザ上でのスクリプト実行とは異なります。",
          "analogy": "SQLインジェクションはデータベース（倉庫）に直接侵入する攻撃、XSSはWebページ（店の看板）に毒を塗ってお客さんを傷つける攻撃です。"
        }
      },
      {
        "id": "d",
        "text": "通信経路上で送受信されるデータを盗み取り、傍受した認証情報を使って不正ログインする攻撃である。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これは中間者攻撃（MITM攻撃）や盗聴の説明です。SQLインジェクションは通信の傍受ではなく、WebアプリケーションへのSQL構文の注入による攻撃です。",
          "analogy": "中間者攻撃は郵便物を途中で開けて読む行為。SQLインジェクションは送り先の住所（データベース）への命令書そのものを改ざんする行為です。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "SQLインジェクションは入力フォームに不正なSQL文を混入させてデータベースを不正操作する攻撃で、プリペアドステートメントが最も有効な対策です。",
      "keyPoint": "「入力値にSQL文を混ぜる → データベースを不正操作」がSQLインジェクションの本質。対策はプリペアドステートメントです。",
      "relatedTopics": ["XSS", "WAF", "プリペアドステートメント", "入力値バリデーション"],
      "studyTip": "試験では「SQLインジェクションの対策として最も有効なもの」を問う選択肢でプリペアドステートメントを選べるようにしましょう。"
    },
    "tags": ["SQLインジェクション", "Webセキュリティ", "データベース", "脆弱性"]
  },
  {
    "questionId": "q-sec-022",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "XSS",
    "level": 4,
    "question": "XSS（クロスサイトスクリプティング）攻撃の説明として、最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "正規のWebサイトに悪意あるスクリプトを埋め込み、そのサイトを閲覧したユーザーのブラウザで不正なスクリプトを実行させる攻撃である。",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "XSSはWebアプリケーションが入力値を適切にエスケープせずにHTMLに出力する脆弱性を悪用します。攻撃者が埋め込んだJavaScriptが被害者のブラウザで実行され、Cookieの盗取・セッションハイジャック・フィッシングページへのリダイレクトなどが行われます。",
          "analogy": "掲示板に「この薬を飲むと元気になります」と書いた毒入りの薬の広告を貼る行為。掲示板の信頼性を利用して、見た人（ユーザー）を騙します。",
          "deepDive": "XSSの種類：①反射型XSS（URLパラメータに含まれたスクリプトがそのまま表示される）、②格納型XSS（DBに保存されたスクリプトが複数ユーザーに影響）、③DOMベースXSS（クライアント側のJS処理で発生）。対策はHTMLエスケープと Content-Security-Policy の設定です。"
        }
      },
      {
        "id": "b",
        "text": "Webサーバのデータベースに不正なSQL文を挿入し、データの漏洩や改ざんを引き起こす攻撃である。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これはSQLインジェクションの説明です。XSSはデータベースへのSQL注入ではなく、Webページ上でのスクリプト実行が攻撃の本質です。",
          "analogy": "SQLインジェクションは倉庫（データベース）への不正侵入、XSSは店舗（Webページ）の商品棚に毒を混ぜてお客さん（ユーザー）を傷つける攻撃です。"
        }
      },
      {
        "id": "c",
        "text": "ユーザーが意図せず悪意あるサイトのリンクをクリックすることで、ユーザーが認証済みの別サイトで不正な操作が実行される攻撃である。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これはCSRF（クロスサイトリクエストフォージェリ）の説明です。XSSはスクリプトの注入・実行、CSRFは認証済みセッションを悪用した不正リクエストの強制実行であり、異なる攻撃手法です。",
          "analogy": "XSSはWebページに罠を仕掛けてユーザーの端末でプログラムを動かす攻撃、CSRFはユーザーに代わって「振込ボタンを押させる」攻撃です。"
        }
      },
      {
        "id": "d",
        "text": "攻撃者がWebサーバとクライアントの通信の間に割り込み、通信内容を盗聴・改ざんする攻撃である。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これは中間者攻撃（MITM：Man In The Middle Attack）の説明です。XSSは通信経路への割り込みではなく、Webページにスクリプトを注入してユーザーのブラウザ上で実行させる攻撃です。",
          "analogy": "中間者攻撃は電話の会話を傍受する行為。XSSは通話相手のスマートフォン（ブラウザ）に悪いアプリを仕込む行為です。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "XSSはWebページに悪意あるスクリプトを埋め込んでユーザーのブラウザで実行させる攻撃で、Cookieの盗取やセッションハイジャックにつながります。",
      "keyPoint": "「スクリプトをWebページに埋め込み→被害者のブラウザで実行」がXSSの本質。対策はHTMLの特殊文字エスケープです。",
      "relatedTopics": ["SQLインジェクション", "CSRF", "Content-Security-Policy", "HTTPOnly属性", "セッションハイジャック"],
      "studyTip": "XSSとCSRFはよく混同されます。XSS=スクリプト実行、CSRF=不正リクエスト強制実行と整理して覚えましょう。"
    },
    "tags": ["XSS", "クロスサイトスクリプティング", "Webセキュリティ", "脆弱性"]
  },
  {
    "questionId": "q-sec-023",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "CSRF",
    "level": 5,
    "question": "CSRF（クロスサイトリクエストフォージェリ）攻撃の説明と、その最も有効な対策の組み合わせとして、適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "Webサーバへの大量リクエストによるサービス停止攻撃であり、対策はCAPTCHAの導入である。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "大量リクエストによるサービス停止はDoS/DDoS攻撃の説明です。CSRFとCAPTCHAの組み合わせも不正確です。CAPTCHAはボットによる自動操作の防止に使われますが、CSRF攻撃が人を介して発動する場合は無効です。",
          "analogy": "CSRFは「あなたの代わりに誰かが銀行に振込を指示する詐欺」であり、「大量の電話で回線をパンクさせる妨害」とは全く別の攻撃です。"
        }
      },
      {
        "id": "b",
        "text": "ユーザーが認証済みの状態を悪用し、ユーザーの意図しないリクエストをWebアプリケーションに送信させる攻撃であり、対策はCSRFトークンの使用である。",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "CSRFは、ユーザーが正規サイトにログイン中（認証済みCookieが有効な状態）に、攻撃者が用意した罠ページを閲覧させることで、ユーザーの意図しないリクエスト（送金・パスワード変更等）を正規サイトに送らせる攻撃です。CSRFトークン（サーバが生成した予測不能な値をフォームに埋め込み、リクエスト時に検証する）が最も有効な対策です。",
          "analogy": "「お使いを頼んだ人が勝手に自分のカードで他の買い物をしてしまう」詐欺のような攻撃。「お使いを依頼するたびに特別な合言葉（CSRFトークン）を渡す」ことで対策できます。",
          "deepDive": "対策の詳細：①CSRFトークン（フォームごとにランダムなトークンを埋め込んでサーバで照合）②SameSite Cookie属性（外部サイトからのリクエスト時にCookieを送らない）③Refererヘッダの確認（補助的手段）。SameSite=Strictが最も強力です。"
        }
      },
      {
        "id": "c",
        "text": "入力フォームから不正なHTMLやスクリプトを注入する攻撃であり、対策は入力値のHTMLエスケープである。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これはXSS（クロスサイトスクリプティング）とその対策の説明です。CSRFとXSSはよく混同されますが、CSRFは「ユーザーに意図しない操作をさせる」攻撃であり、HTMLエスケープはCSRFの対策としては不十分です。",
          "analogy": "XSSは「店の看板に悪い文字を書かれる」攻撃、CSRFは「お客さんに頼んでいないのに店員が勝手に注文処理をする」攻撃です。対策も当然異なります。"
        }
      },
      {
        "id": "d",
        "text": "SQLデータベースへの不正な操作命令を挿入する攻撃であり、対策はプリペアドステートメントの使用である。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これはSQLインジェクションとその対策の説明です。CSRFはデータベースへの不正命令ではなく、Webアプリケーションへの不正リクエストの強制実行を狙います。",
          "analogy": "SQLインジェクションは「倉庫（DB）に直接泥棒が入る」攻撃、CSRFは「正規の従業員を騙して、気づかないうちに泥棒のために扉を開けさせる」攻撃です。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "CSRFはユーザーの認証済みセッションを悪用して意図しないリクエストを発生させる攻撃で、CSRFトークンとSameSite Cookie属性が主な対策です。",
      "keyPoint": "「認証済みユーザーに意図しないリクエストを送らせる」がCSRFの本質。XSSやSQLインジェクションと明確に区別しましょう。",
      "relatedTopics": ["XSS", "セッション管理", "CSRFトークン", "SameSite Cookie", "Referer検証"],
      "studyTip": "CSRF・XSS・SQLインジェクションの3攻撃は試験の頻出セットです。攻撃の標的（サーバ/ブラウザ/DB）と対策をセットで覚えましょう。"
    },
    "tags": ["CSRF", "クロスサイトリクエストフォージェリ", "Webセキュリティ", "CSRFトークン"]
  },
  {
    "questionId": "q-sec-024",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "セッションハイジャック",
    "level": 5,
    "question": "セッションハイジャックに関する説明として、最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "攻撃者がWebサーバの認証を突破し、管理者権限でWebサービスの設定を不正に変更する攻撃である。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これは権限昇格攻撃や不正ログインの説明に近い内容です。セッションハイジャックは認証情報を直接突破するのではなく、既に認証済みのセッションIDを奪取することでなりすましを行います。",
          "analogy": "管理者の部屋の鍵（パスワード）をこじ開けるのが不正ログイン、すでに開いた扉に管理者の代わりにこっそり入り込むのがセッションハイジャックです。"
        }
      },
      {
        "id": "b",
        "text": "攻撃者が正規ユーザーのセッションIDを不正に取得し、そのユーザーになりすましてWebアプリケーションを操作する攻撃である。",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "Webアプリケーションではユーザーがログイン後にセッションIDがCookieに保存されます。攻撃者がこのセッションIDを盗む（XSSによるCookie窃取・盗聴・固定化攻撃等）と、ログインし直さずにそのユーザーとして操作できてしまいます。",
          "analogy": "美術館の入場証（セッションID）を落とした人がいれば、拾った人は再購入なしで美術館に入れます。セッションIDを盗まれた人のアカウントを攻撃者が自由に使えるのが、セッションハイジャックです。",
          "deepDive": "セッションIDの取得手段：①XSSによるCookie窃取、②通信路の盗聴（非HTTPSの場合）、③セッション固定攻撃（あらかじめ特定のセッションIDを使わせる）。対策は①HttpOnly/Secure属性をCookieに付与 ②HTTPS化 ③ログイン後のセッションID再生成 ④セッションタイムアウトの設定です。"
        }
      },
      {
        "id": "c",
        "text": "ユーザーのコンピュータに不正なプログラムをインストールし、遠隔から操作して機密情報を盗み出す攻撃である。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これはリモートアクセス型トロイの木馬（RAT）やマルウェアの説明です。セッションハイジャックはプログラムのインストールではなく、セッションIDという「合言葉」の盗用による攻撃です。",
          "analogy": "RATはコンピュータを丸ごと乗っ取る攻撃、セッションハイジャックは「既に開かれたセッション（ドア）を使ってこっそり入る」攻撃です。"
        }
      },
      {
        "id": "d",
        "text": "ネットワーク機器のセッション（接続状態）の制御を奪い、通信を乗っ取ってネットワーク全体を制御する攻撃である。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "ネットワーク機器のセッションを制御する攻撃はネットワーク層のTCPセッションハイジャックに近い概念ですが、Webセキュリティの文脈でのセッションハイジャックはWebアプリケーションの認証セッションを乗っ取ることを指します。",
          "analogy": "Webのセッションハイジャックはショッピングサイトでのセッション乗っ取りであり、ルータの制御を奪ってインターネット全体を操るのとは全く規模と目的が異なります。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "セッションハイジャックは正規ユーザーのセッションIDを盗んでなりすましを行う攻撃で、Cookieのセキュア設定とHTTPS化が主な対策です。",
      "keyPoint": "「セッションID（入場証）を盗んでなりすます」のがセッションハイジャック。Cookie の HttpOnly/Secure属性でリスクを大幅に低減できます。",
      "relatedTopics": ["XSS", "Cookie", "セッション管理", "HTTPS", "セッション固定攻撃"],
      "studyTip": "試験ではセッションハイジャックの防止策として「HttpOnly属性」「Secure属性」「セッションタイムアウト」「ログイン後のセッションID再生成」が頻出です。"
    },
    "tags": ["セッションハイジャック", "セッション管理", "Cookie", "Webセキュリティ"]
  },
  {
    "questionId": "q-sec-025",
    "examType": "科目A",
    "category": "テクノロジ系",
    "subcategory": "security",
    "topic": "WAF",
    "level": 5,
    "question": "WAF（Web Application Firewall）の説明として、最も適切なものはどれか。",
    "choices": [
      {
        "id": "a",
        "text": "ネットワーク境界に設置し、IPアドレスやポート番号を基準に通信の許可・遮断を制御するセキュリティ機器である。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これはネットワーク層で動作する従来型のファイアウォールの説明です。WAFはIPアドレスやポートではなく、HTTPリクエストの内容（アプリケーション層）を解析して攻撃を検知・遮断する点が異なります。",
          "analogy": "従来のファイアウォールはビルの入口で「入場証を持っているか」を確認する警備員。WAFはさらに踏み込んで「持っている荷物の中身に危険物がないか」を検査する手荷物検査係です。"
        }
      },
      {
        "id": "b",
        "text": "コンピュータウイルスや不正プログラムを検知・隔離し、エンドポイントをマルウェアから保護するソフトウェアである。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "これはエンドポイントセキュリティソフト（アンチウイルス・EDR）の説明です。WAFはクライアント端末ではなくWebアプリケーションへのHTTPリクエストを検査・フィルタリングします。",
          "analogy": "アンチウイルスは自分のパソコンのウイルス検査、WAFはWebサイトへのアクセスに含まれる攻撃コードを入口でブロックするものです。"
        }
      },
      {
        "id": "c",
        "text": "HTTPリクエストの内容を解析し、SQLインジェクションやXSSなどWebアプリケーションへの攻撃を検知・遮断する専用のセキュリティ機器またはソフトウェアである。",
        "isCorrect": true,
        "explanation": {
          "whyCorrect": "WAFはアプリケーション層（L7）でHTTPリクエスト・レスポンスの内容を検査します。SQLインジェクション・XSS・CSRF・OSコマンドインジェクション等の攻撃パターンをシグネチャや振る舞い解析で検知し、悪意あるリクエストを遮断します。通常のファイアウォールでは防げないWebアプリケーション固有の攻撃に対応します。",
          "analogy": "通常の警備員（ファイアウォール）がIDカードを確認するのに対し、WAFはさらに持ち込む会話の内容まで聞いて「怪しい話をしている人は通さない」という高度な警備員です。",
          "deepDive": "WAFの動作方式：①ブラックリスト方式（既知の攻撃パターン=シグネチャと照合）②ホワイトリスト方式（正常なリクエストパターンのみ許可）③ハイブリッド方式。導入形態はクラウド型・アプライアンス型・ソフトウェア型があります。ただしWAFだけでは0-day攻撃は防げないため、安全なコーディングが根本的な対策です。"
        }
      },
      {
        "id": "d",
        "text": "サーバの通信ログを収集・分析し、異常なアクセスを検知したら管理者にアラートを送信する監視システムである。",
        "isCorrect": false,
        "explanation": {
          "whyWrong": "ログ収集・分析・アラート通知はSIEM（セキュリティ情報イベント管理）やIDS（侵入検知システム）の機能です。WAFはログ分析ではなく、リアルタイムでのHTTPリクエスト検査と悪意あるリクエストの遮断が主な役割です。",
          "analogy": "SIEMは後から監視カメラの映像を見て不審者を特定するシステム。WAFはリアルタイムで「危険な荷物を持った人を入口でその場でブロックする」ものです。"
        }
      }
    ],
    "overallExplanation": {
      "summary": "WAFはアプリケーション層でHTTPの内容を検査し、SQLインジェクション・XSS等のWebアプリケーション固有の攻撃をリアルタイムで検知・遮断します。",
      "keyPoint": "通常のFW=L3/L4でIPアドレス・ポートで判断、WAF=L7でHTTPの中身（SQLインジェクション等の攻撃パターン）を検査。両者は補完関係にあります。",
      "relatedTopics": ["ファイアウォール", "IDS/IPS", "SQLインジェクション", "XSS", "OWASP"],
      "studyTip": "試験では「WAFで防げる攻撃」と「防げない攻撃」の区別が問われることがあります。WAFはHTTPレイヤーの攻撃には有効ですが、ネットワーク層の攻撃（DoS等）には通常のFWが必要です。"
    },
    "tags": ["WAF", "Webアプリケーションファイアウォール", "SQLインジェクション", "XSS", "Webセキュリティ"]
  }
]
